{"version":3,"sources":["file:///D:/PA_2024/3D/MergeCraft/MergeCraft_Op7/assets/Script/Controller/RangerControl.ts"],"names":["_decorator","Component","ERigidBodyType","BoxCollider","RigidBody","math","SkeletalAnimation","ccclass","property","RangerControl","start","getComponent","play","rigidbody","node","collider","on","e","otherCollider","name","selfCollider","type","STATIC","isFight","die","scheduleOnce","active","stop","Run","DYNAMIC","parent","setLinearVelocity","Vec3","isRun","runStep2"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, ERigidBodyType, BoxCollider, RigidBody, ICollisionEvent, math, SkeletalAnimation, Vec3 } from 'cc';\nimport { CharacterControl } from './CharacterControl';\nimport { Constants } from '../Data/Constant';\nconst { ccclass, property } = _decorator;\n\n@ccclass('RangerControl')\nexport class RangerControl extends Component {\n\n    isRun: boolean = false;\n    isFight: boolean = false;\n    rigidbody: RigidBody;\n    collider: BoxCollider;\n\n\n    protected start(): void {\n        this.getComponent(SkeletalAnimation).play(\"Idle_1\");\n\n        this.rigidbody = this.node.getComponent(RigidBody);\n        this.collider = this.node.getComponent(BoxCollider);\n\n        this.collider.on(\"onCollisionEnter\", (e: ICollisionEvent) => {\n            if (e.otherCollider.node.name === \"Rex\" && e.selfCollider.node.name !== \"Unit_9\") {\n                this.rigidbody.type = ERigidBodyType.STATIC;\n                this.isFight = true;\n                this.die();\n            }\n\n            if (e.selfCollider.node.name === \"Unit_9\") {\n                this.rigidbody.type = ERigidBodyType.STATIC;\n                this.isFight = true;\n                this.die();\n            }\n        });\n    }\n\n\n    private die(): void {\n        this.node.getComponent(SkeletalAnimation).play(\"Die\");\n\n        this.scheduleOnce(() => {\n            this.node.active = false;\n            this.node.getComponent(SkeletalAnimation).stop()\n        }, 1.5);\n    }\n\n\n    private Run(): void {\n        this.rigidbody.type = ERigidBodyType.DYNAMIC;\n\n        switch (this.node.parent.name) {\n            case \"Unit_9\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-3, 0, -12))\n                break;\n            case \"Unit_10\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-10, 0, -12))\n                break;\n            case \"Unit_11\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-10, 0, -12))\n                break;\n            case \"Unit_12\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-10, 0, -12))\n                break;\n            case \"Unit_13\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-5, 0, -12))\n                break;\n            case \"Unit_14\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-5, 0, -12))\n                break;\n            default:\n                break;\n        }\n\n        if (!this.isRun) {\n            this.isRun = true;\n            this.getComponent(SkeletalAnimation).play(\"Run\");\n        }\n    }\n\n\n    private runStep2(): void {\n        this.rigidbody.type = ERigidBodyType.DYNAMIC;\n\n        switch (this.node.parent.name) {\n            case \"Unit_1\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(12, 0, -13))\n                break;\n            case \"Unit_2\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(10, 0, -13))\n                break;\n            case \"Unit_3\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(10, 0, -13))\n                break;\n            case \"Unit_4\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(10, 0, -13))\n                break;\n            case \"Unit_5\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(5, 0, -13))\n                break;\n            case \"Unit_6\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(5, 0, -13))\n                break;\n            case \"Unit_7\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(11, 0, -13))\n                break;\n            case \"Unit_8\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(11, 0, -13))\n                break;\n        }\n\n\n        if (!this.isRun) {\n            this.isRun = true;\n            this.getComponent(SkeletalAnimation).play(\"Run\");\n        }\n    }\n\n\n    // protected update(dt: number): void {\n    //     if (Constants.isFightStep1 && !this.isFight && !Constants.isFailStep1) {\n    //         this.Run();\n    //     }\n\n    //     if(Constants.isFightStep2 && !this.isFight && Constants.isStartStep2) {\n    //         this.runStep2();\n    //     }\n    // }\n}\n"]}