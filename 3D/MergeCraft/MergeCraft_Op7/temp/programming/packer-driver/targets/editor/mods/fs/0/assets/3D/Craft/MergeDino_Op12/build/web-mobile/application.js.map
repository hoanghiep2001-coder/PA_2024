{"version":3,"sources":["file:///D:/PA_2024/3D/MergeCraft/MergeCraft_Op7/assets/3D/Craft/MergeDino_Op12/build/web-mobile/application.js"],"names":["System","register","_export","_context","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","createApplication","_ref","loadJsListFile","fetchWasm","promise","Promise","resolve","then","start","topLevelImport","_ref3","findCanvas","settings","cc","engine","loadSettingsJson","window","_CCSettings","initializeGame","renderPipeline","game","run","scriptPackages","loadModulePacks","loadJsList","jsList","loadAssetBundle","hasResourcesBundle","hasStartSceneBundle","onStart","onGameStarted","bind","url","concat","_cc$AssetManager$Buil","AssetManager","BuiltinBundleName","MAIN","RESOURCES","START_SCENE","bundleRoot","push","reduce","pre","name","loadBundle","reject","assetManager","err","bundle","packs","all","map","pack","forEach","jsListFile","fsUtils","startsWith","result","readJsonSync","Error","requestSettings","xhr","XMLHttpRequest","open","responseType","onload","JSON","parse","response","onerror","retryCount","setTimeout","retryInterval","send","macros","macro","gameOptions","getGameOptions","success","init","customLayers","layer","Layers","addLayer","bit","error","console","warn","undefined","view","resizeWithBrowserSize","launchScene","director","loadScene","setDesignResolutionSize","log","assetOptions","bundleVers","remoteBundles","server","subpackages","options","debugMode","debug","DebugMode","INFO","ERROR","showFPS","frameRate","groupList","collisionMatrix","adapter","customJointTextureLayouts","physics","orientation","exactFitScreen","setters","execute"],"mappings":"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","sourcesContent":["System.register([], function (_export, _context) {\n  \"use strict\";\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function createApplication(_ref) {\n    var loadJsListFile = _ref.loadJsListFile,\n        fetchWasm = _ref.fetchWasm;\n    // NOTE: before here we shall not import any module!\n    var promise = Promise.resolve();\n    return promise.then(function () {\n      return _defineProperty({\n        start: start\n      }, 'import', topLevelImport);\n    });\n\n    function start(_ref3) {\n      var findCanvas = _ref3.findCanvas;\n      var settings;\n      var cc;\n      return Promise.resolve().then(function () {\n        return topLevelImport('cc');\n      }).then(function (engine) {\n        cc = engine;\n        return loadSettingsJson(cc);\n      }).then(function () {\n        settings = window._CCSettings;\n        return initializeGame(cc, settings, findCanvas).then(function () {\n          if (!settings.renderPipeline) return cc.game.run();\n        }).then(function () {\n          if (settings.scriptPackages) {\n            return loadModulePacks(settings.scriptPackages);\n          }\n        }).then(function () {\n          return loadJsList(settings.jsList);\n        }).then(function () {\n          return loadAssetBundle(settings.hasResourcesBundle, settings.hasStartSceneBundle);\n        }).then(function () {\n          if (settings.renderPipeline) return cc.game.run();\n        }).then(function () {\n          cc.game.onStart = onGameStarted.bind(null, cc, settings);\n          onGameStarted(cc, settings);\n        });\n      });\n    }\n\n    function topLevelImport(url) {\n      return _context[\"import\"](\"\".concat(url));\n    }\n\n    function loadAssetBundle(hasResourcesBundle, hasStartSceneBundle) {\n      var promise = Promise.resolve();\n      var _cc$AssetManager$Buil = cc.AssetManager.BuiltinBundleName,\n          MAIN = _cc$AssetManager$Buil.MAIN,\n          RESOURCES = _cc$AssetManager$Buil.RESOURCES,\n          START_SCENE = _cc$AssetManager$Buil.START_SCENE;\n      var bundleRoot = hasResourcesBundle ? [RESOURCES, MAIN] : [MAIN];\n\n      if (hasStartSceneBundle) {\n        bundleRoot.push(START_SCENE);\n      }\n\n      return bundleRoot.reduce(function (pre, name) {\n        return pre.then(function () {\n          return loadBundle(name);\n        });\n      }, Promise.resolve());\n    }\n\n    function loadBundle(name) {\n      return new Promise(function (resolve, reject) {\n        cc.assetManager.loadBundle(name, function (err, bundle) {\n          if (err) {\n            return reject(err);\n          }\n\n          resolve(bundle);\n        });\n      });\n    }\n\n    function loadModulePacks(packs) {\n      return Promise.all(packs.map(function (pack) {\n        return topLevelImport(pack);\n      }));\n    }\n\n    function loadJsList(jsList) {\n      var promise = Promise.resolve();\n      jsList.forEach(function (jsListFile) {\n        promise = promise.then(function () {\n          return loadJsListFile(\"src/\".concat(jsListFile));\n        });\n      });\n      return promise;\n    }\n\n    function loadSettingsJson(cc) {\n      var settings = 'src/settings.json';\n      return new Promise(function (resolve, reject) {\n        if (typeof fsUtils !== 'undefined' && !settings.startsWith('http')) {\n          var result = fsUtils.readJsonSync(settings);\n\n          if (result instanceof Error) {\n            reject(result);\n          } else {\n            window._CCSettings = result;\n            resolve();\n          }\n        } else {\n          var requestSettings = function requestSettings() {\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', settings);\n            xhr.responseType = 'text';\n\n            xhr.onload = function () {\n              window._CCSettings = JSON.parse(xhr.response);\n              resolve();\n            };\n\n            xhr.onerror = function () {\n              if (retryCount-- > 0) {\n                setTimeout(requestSettings, retryInterval);\n              } else {\n                reject(new Error('request settings failed!'));\n              }\n            };\n\n            xhr.send(null);\n          };\n\n          var retryCount = 3;\n          var retryInterval = 2000;\n          requestSettings();\n        }\n      });\n    }\n  }\n\n  function initializeGame(cc, settings, findCanvas) {\n    if (settings.macros) {\n      for (var key in settings.macros) {\n        cc.macro[key] = settings.macros[key];\n      }\n    }\n\n    var gameOptions = getGameOptions(cc, settings, findCanvas);\n    var success = cc.game.init(gameOptions);\n\n    try {\n      if (settings.customLayers) {\n        settings.customLayers.forEach(function (layer) {\n          cc.Layers.addLayer(layer.name, layer.bit);\n        });\n      }\n    } catch (error) {\n      console.warn(error);\n    }\n\n    return success ? Promise.resolve(success) : Promise.reject();\n  }\n\n  function onGameStarted(cc, settings) {\n    window._CCSettings = undefined;\n    cc.view.resizeWithBrowserSize(true);\n    var launchScene = settings.launchScene; // load scene\n\n    cc.director.loadScene(launchScene, null, function () {\n      cc.view.setDesignResolutionSize(320, 480, 2);\n      console.log(\"Success to load scene: \".concat(launchScene));\n    });\n  }\n\n  function getGameOptions(cc, settings, findCanvas) {\n    // asset library options\n    var assetOptions = {\n      bundleVers: settings.bundleVers,\n      remoteBundles: settings.remoteBundles,\n      server: settings.server,\n      subpackages: settings.subpackages\n    };\n    var options = {\n      debugMode: settings.debug ? cc.DebugMode.INFO : cc.DebugMode.ERROR,\n      showFPS: !false && settings.debug,\n      frameRate: 60,\n      groupList: settings.groupList,\n      collisionMatrix: settings.collisionMatrix,\n      renderPipeline: settings.renderPipeline,\n      adapter: findCanvas('GameCanvas'),\n      assetOptions: assetOptions,\n      customJointTextureLayouts: settings.customJointTextureLayouts || [],\n      physics: settings.physics,\n      orientation: settings.orientation,\n      exactFitScreen: settings.exactFitScreen\n    };\n    return options;\n  }\n\n  _export(\"createApplication\", createApplication);\n\n  return {\n    setters: [],\n    execute: function () {}\n  };\n});"]}