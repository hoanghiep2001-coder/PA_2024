{"version":3,"sources":["file:///D:/PA_2024/3D/MergeRobo/MergeRobo_Op8/assets/Script/Controller/RangerControl.ts"],"names":["_decorator","Component","ERigidBodyType","BoxCollider","RigidBody","math","SkeletalAnimation","Constants","ccclass","property","RangerControl","start","getComponent","play","rigidbody","node","collider","on","e","otherCollider","name","console","log","selfCollider","type","STATIC","isFight","die","scheduleOnce","active","stop","Run","DYNAMIC","parent","setLinearVelocity","Vec3","isRun","runStep2","update","dt","isFightStep1","isFailStep1","isFightStep2","isStartStep2"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, ERigidBodyType, BoxCollider, RigidBody, ICollisionEvent, math, SkeletalAnimation, Vec3 } from 'cc';\nimport { CharacterControl } from './CharacterControl';\nimport { Constants } from '../Data/Constant';\nconst { ccclass, property } = _decorator;\n\n@ccclass('RangerControl')\nexport class RangerControl extends Component {\n\n    isRun: boolean = false;\n    isFight: boolean = false;\n    rigidbody: RigidBody;\n    collider: BoxCollider;\n\n\n    protected start(): void {\n        this.getComponent(SkeletalAnimation).play(\"idle\");\n\n        this.rigidbody = this.node.getComponent(RigidBody);\n        this.collider = this.node.getComponent(BoxCollider);\n\n        this.collider.on(\"onCollisionEnter\", (e: ICollisionEvent) => {                \n            if (e.otherCollider.node.name === \"Robo_Boss\") {\n                console.log(e.selfCollider.node.name);\n                \n                this.rigidbody.type = ERigidBodyType.STATIC;\n                this.isFight = true;\n                this.die();\n            }\n\n            // if (e.selfCollider.node.name === \"Robo_9\") {\n            //     this.rigidbody.type = ERigidBodyType.STATIC;\n            //     this.isFight = true;\n            //     this.die();\n            // }\n        });\n    }\n\n\n    private die(): void {\n        this.node.getComponent(SkeletalAnimation).play(\"die\");\n\n        this.scheduleOnce(() => {\n            this.node.active = false;\n            this.node.getComponent(SkeletalAnimation).stop()\n        }, 1.5);\n    }\n\n\n    private Run(): void {\n        this.rigidbody.type = ERigidBodyType.DYNAMIC;\n\n        switch (this.node.parent.name) {\n            case \"Unit_9\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-3, 0, -7))\n                break;\n            case \"Unit_10\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-10, 0, -7))\n                break;\n            case \"Unit_11\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-5, 0, -7))\n                break;\n            case \"Unit_12\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-5, 0, -10))\n                break;\n            case \"Unit_13\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-1, 0, -10))\n                break;\n            case \"Unit_14\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(-5, 0, -7))\n                break;\n            default:\n                break;\n        }\n\n        if (!this.isRun) {\n            this.isRun = true;\n            this.getComponent(SkeletalAnimation).play(\"walk\");\n        }\n    }\n\n\n    private runStep2(): void {\n        this.rigidbody.type = ERigidBodyType.DYNAMIC;\n\n        switch (this.node.parent.name) {\n            case \"Unit_1\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(12, 0, -11))\n                break;\n            case \"Unit_2\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(10, 0, -11))\n                break;\n            case \"Unit_3\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(10, 0, -11))\n                break;\n            case \"Unit_4\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(0, 0, -12))\n                break;\n            case \"Unit_5\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(0, 0, -12))\n                break;\n            case \"Unit_6\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(5, 0, -12))\n                break;\n            case \"Unit_7\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(5, 0, -11))\n                break;\n            case \"Unit_8\":\n                this.rigidbody.setLinearVelocity(new math.Vec3(9, 0, -13))\n                break;\n        }\n\n\n        if (!this.isRun) {\n            this.isRun = true;\n            this.getComponent(SkeletalAnimation).play(\"walk\");\n        }\n    }\n\n\n    protected update(dt: number): void {\n        if (Constants.isFightStep1 && !this.isFight && !Constants.isFailStep1) {\n            this.Run();\n        }\n\n        if(Constants.isFightStep2 && !this.isFight && Constants.isStartStep2) {\n            this.runStep2();\n        }\n    }\n}\n"]}