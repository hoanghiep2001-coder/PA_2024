{"version":3,"sources":["file:///D:/PlayableAds/PA_2024/3D/MergeDino/MergeDino_Op9/assets/Script/Controller/TouchAreaController.ts"],"names":["_decorator","Component","Node","Vec3","Constants","Utils","NodesController","ccclass","property","TouchAreaController","start","registerEvent","hideMask","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","TOUCH_CANCEL","isTouching","hint_1","active","event","stick","screenPos","getUILocation","pos","convertToLocalLocation","point","setPosition","TouchArea","checkMergeFirstStep","isDoneMergeStep1","init","value","localX","x","node","getPosition","localY","y","result"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAwBC,MAAAA,I,OAAAA,I;;AAC/CC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,e,iBAAAA,e;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;qCAGjBS,mB,WADZF,OAAO,CAAC,qBAAD,C,UAGLC,QAAQ;AAAA;AAAA,6C,oCAHX,MACaC,mBADb,SACyCR,SADzC,CACmD;AAAA;AAAA;;AAAA;;AAAA,uCAOrC,IAPqC;AAAA;;AAUvCS,QAAAA,KAAK,GAAS;AACtB,eAAKC,aAAL;AACD;;AAGOA,QAAAA,aAAa,GAAS;AAC5B,eAAKL,eAAL,CAAqBM,QAArB,CAA8BC,EAA9B,CAAiCX,IAAI,CAACY,SAAL,CAAeC,WAAhD,EAA6D,KAAKC,UAAlE,EAA8E,IAA9E;AACA,eAAKV,eAAL,CAAqBM,QAArB,CAA8BC,EAA9B,CAAiCX,IAAI,CAACY,SAAL,CAAeG,UAAhD,EAA4D,KAAKC,SAAjE,EAA4E,IAA5E;AACA,eAAKZ,eAAL,CAAqBM,QAArB,CAA8BC,EAA9B,CAAiCX,IAAI,CAACY,SAAL,CAAeK,SAAhD,EAA2D,KAAKC,QAAhE,EAA0E,IAA1E;AACA,eAAKd,eAAL,CAAqBM,QAArB,CAA8BC,EAA9B,CAAiCX,IAAI,CAACY,SAAL,CAAeO,YAAhD,EAA8D,KAAKD,QAAnE,EAA6E,IAA7E;AACD;;AAGOJ,QAAAA,UAAU,GAAS;AACzB;AAAA;AAAA,sCAAUM,UAAV,GAAuB,IAAvB;AACA,eAAKhB,eAAL,CAAqBiB,MAArB,CAA4BC,MAA5B,GAAqC,KAArC;AACD;;AAGON,QAAAA,SAAS,CAACO,KAAD,EAAoBC,KAApB,EAAiC;AAChD,cAAMC,SAAS,GAAGF,KAAK,CAACG,aAAN,EAAlB;AACA,eAAKC,GAAL,GAAW,KAAKC,sBAAL,CAA4BH,SAA5B,CAAX;AACA,eAAKrB,eAAL,CAAqByB,KAArB,CAA2BC,WAA3B,CAAuC,KAAKH,GAA5C;AACA;AAAA;AAAA,8BAAMI,SAAN,CAAgBC,mBAAhB;AACD;;AAGOd,QAAAA,QAAQ,GAAS;AACvB;AAAA;AAAA,sCAAUE,UAAV,GAAuB,KAAvB;;AAEA,cAAG,CAAC;AAAA;AAAA,sCAAUa,gBAAd,EAAgC;AAC9B,iBAAK7B,eAAL,CAAqB8B,IAArB;AACD;AACF;;AAGON,QAAAA,sBAAsB,CAACO,KAAD,EAAoB;AAChD,cAAMC,MAAM,GAAGD,KAAK,CAACE,CAAN,GAAU,GAAV,GAAgB,KAAKC,IAAL,CAAUC,WAAV,GAAwBF,CAAvD;AACA,cAAMG,MAAM,GAAGL,KAAK,CAACM,CAAN,GAAU,GAAV,GAAgB,KAAKH,IAAL,CAAUC,WAAV,GAAwBE,CAAvD;AACA,cAAMC,MAAM,GAAG,IAAIzC,IAAJ,CAASmC,MAAT,EAAiBI,MAAjB,EAAyB,CAAzB,CAAf;AACA,iBAAOE,MAAP;AACD;;AAnDgD,O;;;;;iBAGd,I","sourcesContent":["import { _decorator, Component, Node, Vec2, EventTouch, Vec3 } from \"cc\";\r\nimport { Constants } from \"../Data/Constant\";\r\nimport { Utils } from \"../Plugin/Utils\";\r\nimport { NodesController } from \"./NodesController\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"TouchAreaController\")\r\nexport class TouchAreaController extends Component {\r\n\r\n  @property(NodesController)\r\n  NodesController: NodesController = null;\r\n\r\n\r\n  // state\r\n  pos: Vec3 = null;\r\n\r\n\r\n  protected start(): void {\r\n    this.registerEvent();\r\n  }\r\n\r\n\r\n  private registerEvent(): void {\r\n    this.NodesController.hideMask.on(Node.EventType.TOUCH_START, this.touchStart, this);\r\n    this.NodesController.hideMask.on(Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n    this.NodesController.hideMask.on(Node.EventType.TOUCH_END, this.touchEnd, this);\r\n    this.NodesController.hideMask.on(Node.EventType.TOUCH_CANCEL, this.touchEnd, this);\r\n  }\r\n\r\n\r\n  private touchStart(): void {\r\n    Constants.isTouching = true;\r\n    this.NodesController.hint_1.active = false;\r\n  }\r\n\r\n\r\n  private touchMove(event: EventTouch, stick: Node) {\r\n    const screenPos = event.getUILocation();\r\n    this.pos = this.convertToLocalLocation(screenPos);\r\n    this.NodesController.point.setPosition(this.pos);\r\n    Utils.TouchArea.checkMergeFirstStep();\r\n  }\r\n\r\n\r\n  private touchEnd(): void {\r\n    Constants.isTouching = false;\r\n\r\n    if(!Constants.isDoneMergeStep1) {\r\n      this.NodesController.init();\r\n    }\r\n  }\r\n\r\n\r\n  private convertToLocalLocation(value: Vec2): Vec3 {\r\n    const localX = value.x - 160 - this.node.getPosition().x;\r\n    const localY = value.y - 240 - this.node.getPosition().y;\r\n    const result = new Vec3(localX, localY, 0);\r\n    return result;\r\n  }\r\n}\r\n"]}