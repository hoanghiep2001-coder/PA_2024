{"version":3,"sources":["file:///D:/PA_2024/3D/FishIO/FishIO_Op7/assets/scripts/Controller/TouchAreaController.ts"],"names":["_decorator","Component","Node","Vec3","Vec2","Camera","Animation","UIOpacity","sp","PlayerController","Constants","GameController","AudioManager","IronSource","SkiingController","ccclass","property","TouchAreaController","start","init","registerEvent","levelPlayer","player","getChildByName","playerSpine","getComponent","Skeleton","playerController","stickPointUIOpacity","stickPoint","tutorialOpacity","tutorial","toStore","hideMask","on","EventType","TOUCH_START","installHandle","Button_Left","Skiing_BtnLeftTouchStart","Button_Up","Skiing_BtnUpTouchStart","Skiiing_hideMask","handleIronSourcePlaySound","onHideMaskTouchStart","TOUCH_MOVE","onHideMaskTouchMove","TOUCH_END","onHideMaskTouchEnd","TOUCH_CANCEL","offEvent","off","isCanClickBtnLeft","isClickBtnLeft","Skiing_hand","active","isJumping","isCanClick","isClickBtnJump","Skiing_overlay","playSound","SoundTrack","Skiing_JumpSound","scheduleOnce","event","isLive","isCompleteVideo","flagReplay","isPlayGame","isTouching","isMove","opacity","stop","setAnimation","timeScale","forceReplay","touchPos","getUILocation","localTouch","convertToLocalLocation","positionTouch","x","camera","node","getPosition","y","handleStickPos","move","handleShowTutorialAgain","newStickPos","angleInRadian","Math","atan2","angleCount","PI","setPosition","play","HandleAnglePlayer","angle","setScale","value","localX","localY","result"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, Node, Vec3, Vec2, Camera, Animation, UIOpacity, sp, log } from 'cc';\nimport { PlayerController } from './PlayerController';\nimport { Constants } from '../Data/Constant';\nimport { GameController } from './GameController';\nimport { AudioManager } from './AudioManager';\nimport { IronSource } from '../Data/IronSource';\nimport { SkiingController } from './SkiingController';\nconst { ccclass, property } = _decorator;\n\n@ccclass('TouchAreaController')\nexport class TouchAreaController extends Component {\n  @property(IronSource)\n  IronSource: IronSource = null;\n  @property(AudioManager)\n  AudioManager: AudioManager = null;\n  @property(GameController)\n  GameController: GameController = null;\n  @property(SkiingController)\n  SkiingController: SkiingController = null;\n  @property(Camera)\n  camera: Camera = null;\n\n\n  @property(Node)\n  Skiiing_hideMask: Node = null;\n  @property(Node)\n  Skiing_hand: Node = null;\n  @property(Node)\n  Skiing_hand_2: Node = null;\n  @property(Node)\n  Skiing_overlay: Node = null;\n\n\n  @property(Node)\n  player: Node = null;\n  @property(Node)\n  fakeHideMask: Node = null;\n  @property(Node)\n  hideMask: Node = null;\n  @property(Node)\n  tutorial: Node = null;\n  @property(Node)\n  stickPoint: Node = null;\n\n\n  playerController: PlayerController = null;\n  stickPointUIOpacity: UIOpacity = null;\n  tutorialOpacity: UIOpacity = null;\n  levelPlayer: Node = null;\n  playerSpine: sp.Skeleton = null;\n\n  positionTouch: Vec3 = new Vec3(0, 0, 0);\n  localTouch: Vec3 = new Vec3(0, 0, 0);\n  locationPos: Vec2 = new Vec2(0, 0);\n  angleCount: number = null;\n\n\n  protected start(): void {\n    // toStore\n    // Constants.toStore = true;\n\n    this.init();\n    this.registerEvent();\n  }\n\n\n  private init(): void {\n    this.levelPlayer = this.player.getChildByName(\"Body\").getChildByName(\"Level\");\n    this.playerSpine = this.player.getChildByName(\"Body\").getChildByName(\"Spine_Fish\").getComponent(sp.Skeleton);\n    this.playerController = this.player.getComponent(PlayerController);\n    this.stickPointUIOpacity = this.stickPoint.getComponent(UIOpacity);\n    this.tutorialOpacity = this.tutorial.getComponent(UIOpacity);\n  }\n\n\n  public registerEvent(): void {\n    if (Constants.toStore) {\n      this.hideMask.on(Node.EventType.TOUCH_START, this.GameController.installHandle, this);\n      return;\n    };\n\n    this.SkiingController.Button_Left.on(Node.EventType.TOUCH_START, this.Skiing_BtnLeftTouchStart, this);\n    this.SkiingController.Button_Up.on(Node.EventType.TOUCH_START, this.Skiing_BtnUpTouchStart, this);\n    // ironsource\n    this.Skiiing_hideMask.on(Node.EventType.TOUCH_START, this.IronSource.handleIronSourcePlaySound, this);\n\n    this.hideMask.on(Node.EventType.TOUCH_START, this.onHideMaskTouchStart, this);\n    this.hideMask.on(Node.EventType.TOUCH_MOVE, this.onHideMaskTouchMove, this);\n    this.hideMask.on(Node.EventType.TOUCH_END, this.onHideMaskTouchEnd, this);\n    this.hideMask.on(Node.EventType.TOUCH_CANCEL, this.onHideMaskTouchEnd, this);\n  };\n\n\n  public offEvent() {\n    this.hideMask.off(Node.EventType.TOUCH_START);\n    this.hideMask.off(Node.EventType.TOUCH_MOVE);\n    this.hideMask.off(Node.EventType.TOUCH_END);\n    this.hideMask.off(Node.EventType.TOUCH_CANCEL);\n  };\n\n\n  private Skiing_BtnLeftTouchStart(): void { \n    if (!Constants.isCanClickBtnLeft) return; \n    Constants.isClickBtnLeft = true; \n    this.Skiing_hand.active = false; \n    this.IronSource.handleIronSourcePlaySound();\n  }\n  private Skiing_BtnUpTouchStart(): void {\n    if (Constants.isJumping || !Constants.isCanClick) return; // Kiểm tra xem đã chạm đất và có thể nhấn nhảy\n    Constants.isClickBtnLeft = true;\n    Constants.isCanClick = false;\n    Constants.isClickBtnJump = true;\n    this.IronSource.handleIronSourcePlaySound();\n    this.Skiing_hand.active = false;\n    this.Skiing_overlay.active = false;\n    this.AudioManager.playSound(Constants.SoundTrack.Skiing_JumpSound);\n    this.scheduleOnce(() => {\n      Constants.isClickBtnJump = false;\n    }, 0.5); \n  }\n\n\n  private onHideMaskTouchStart(event: EventTouch) {\n    if (!this.playerController.isLive || !Constants.isCompleteVideo) {\n      return;\n    }\n\n\n    if (Constants.flagReplay) {\n      this.GameController.installHandle();\n      return;\n    }\n\n    Constants.isPlayGame = true;\n    Constants.isTouching = true;\n    this.playerController.isMove = true;\n    this.stickPointUIOpacity.opacity = 180;\n    this.tutorialOpacity.opacity = 0;\n    this.tutorial.getComponent(Animation).stop();\n    this.playerSpine.setAnimation(0, \"eat\", true);\n    this.playerSpine.timeScale = 1;\n    // this.IronSource.handleIronSourcePlaySound();\n  }\n\n\n  private onHideMaskTouchMove(event: EventTouch) {\n    if (!this.playerController.isLive || Constants.forceReplay || !Constants.isCompleteVideo) {\n      return;\n    }\n\n    let touchPos = event.getUILocation();\n    this.localTouch = this.convertToLocalLocation(touchPos);\n    this.positionTouch = this.localTouch;\n\n    this.positionTouch.x += this.camera.node.getPosition().x;\n    this.positionTouch.y += this.camera.node.getPosition().y;\n\n    this.handleStickPos();\n    this.playerController.move();\n  }\n\n\n  private onHideMaskTouchEnd(): void {\n    Constants.isTouching = false;\n    this.playerController.isMove = false;\n    this.playerController.stop();\n    this.stickPointUIOpacity.opacity = 0;\n    this.playerSpine.setAnimation(0, \"idle\", true);\n    this.playerSpine.timeScale = 1.5;\n    this.handleShowTutorialAgain();\n  }\n\n\n  // clear fix bug from 14/12/2023\n  // critical bug: Not get the exactly pos of stickPoint in 3D env.\n  // --- update 19/12/2023: Fixed\n  // --- Dev: Hiep\n  private handleStickPos(): void {\n    let newStickPos = new Vec3(\n      this.positionTouch.x -= this.camera.node.getPosition().x,\n      this.positionTouch.y -= this.camera.node.getPosition().y,\n      0\n    );\n\n    // count angle of player\n    let angleInRadian = Math.atan2(newStickPos.y, newStickPos.x);\n    this.angleCount = angleInRadian * (180 / Math.PI);\n    this.stickPoint.setPosition(newStickPos);\n    // --------------------\n  }\n\n\n  private handleShowTutorialAgain(): void {\n    this.scheduleOnce(() => {\n      if (Constants.isTouching) {\n        return;\n      };\n      this.tutorial.getComponent(Animation).play(\"Tutorial_ShowAnim\");\n    }, 3);\n  }\n\n\n  public HandleAnglePlayer(player: Node): void {\n    player.angle = this.angleCount;\n\n    if (this.angleCount >= 90 || this.angleCount <= -90) {\n      player.setScale(new Vec3(-1, -1, 1.2))\n      this.levelPlayer.setScale(new Vec3(0.5, 0.5, 0.5));\n    } else {\n      player.setScale(new Vec3(-1, 1, 1))\n      this.levelPlayer.setScale(new Vec3(-0.5, 0.5, 0.5));\n    }\n  }\n\n\n  public convertToLocalLocation(value: Vec2): Vec3 {\n    const localX: number = value.x - 240;\n    const localY: number = value.y - 160;\n    const result = new Vec3(localX, localY, 0);\n    return result;\n  }\n}\n\n"]}