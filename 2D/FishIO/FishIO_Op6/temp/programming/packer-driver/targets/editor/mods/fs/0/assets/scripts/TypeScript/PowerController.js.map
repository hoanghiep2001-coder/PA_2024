{"version":3,"sources":["file:///D:/playable-ads-hiepdh/FishIO/FishIO_Op6/assets/scripts/TypeScript/PowerController.ts"],"names":["_decorator","Component","Node","Animation","Camera","Label","math","sp","tween","JoyStick","Player","ccclass","property","PowerController","Skeleton","start","callTween","collide","scale","prevScale","level","getChildByName","component","getComponent","Mount","score","console","log","fontSize","lineHeight","to","Vec3","call","handlePowerUp","otherCollide","touchArea","isTouched","spine","setAnimation","isLevel2","isTransforming","destroy","offEvent","Spine_Bubble","node","active","scheduleOnce","Spine_PlayerPower","zoomRatio","handlePowerUpLv2","isLevel3","Button_CTA","play","Hand_CTA"],"mappings":"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","sourcesContent":["import { JoyStick } from \"./JoyStick\";\r\nimport Player from \"./PlayerMount\";\r\nimport { _decorator, Component, Node, Prefab,Animation,Camera,Label, instantiate, RigidBody2D, Vec2, Vec3, toRadian, math, Skeleton, sp, tween } from 'cc';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass\r\nexport default class PowerController extends Component {\r\n\r\n  @property(Player)\r\n  Mount: Player = null;\r\n  @property(JoyStick)\r\n  JoyStick: JoyStick = null;\r\n\r\n  @property(Camera)\r\n  Camera: Camera = null;\r\n  @property(sp.Skeleton)\r\n  Spine_Bubble: sp.Skeleton = null;\r\n  @property(sp.Skeleton)\r\n  Spine_PlayerPower: sp.Skeleton = null;\r\n  @property(Node)\r\n  touchArea: Node = null;\r\n  @property(Node)\r\n  Button_CTA: Node = null;\r\n  @property(Node)\r\n  Hand_CTA: Node = null;\r\n\r\n  isTransforming: boolean = false;\r\n  isLevel2: boolean = false;\r\n  isLevel3: boolean = false;\r\n\r\n\r\n  protected start(): void {\r\n\r\n  }\r\n\r\n\r\n  private callTween(collide: Node, scale: number, prevScale: number): void {\r\n    let level = collide.getChildByName(\"Body\").getChildByName(\"Level\");\r\n    let component = level.getComponent(Label);\r\n    this.Mount.score = this.Mount.score*10;\r\n    console.log(this.Mount.score);\r\n    \r\n    if(scale == 2.2) {      \r\n      component.fontSize = 30;\r\n      component.lineHeight = 30;\r\n    } else {\r\n      component.fontSize = 25;\r\n      component.lineHeight = 25;\r\n    }\r\n\r\n    tween(collide)\r\n      .to(0.1, { scale: new math.Vec3(scale, scale, 0) })\r\n      .call(() => {\r\n        tween(collide)\r\n          .to(0.1, { scale: new math.Vec3(prevScale, prevScale, 0) })\r\n          .start()\r\n      })\r\n      .start();\r\n  }\r\n\r\n\r\n  public handlePowerUp(collide: Node, otherCollide: Node): void {\r\n    // this.JoyStick.node.opacity = 0;\r\n    this.touchArea.getComponent(\"TouchArea\").isTouched = false;\r\n    let spine = collide.getChildByName(\"Body\").getChildByName(\"Spine_Fish\").getComponent(sp.Skeleton);\r\n    spine.setAnimation(0, \"idle\", true);\r\n    this.isLevel2 = true;\r\n    this.isTransforming = true;\r\n    otherCollide.destroy();\r\n    this.touchArea.getComponent(\"TouchArea\").offEvent();\r\n    this.Spine_Bubble.node.active = true;\r\n    this.Spine_Bubble.setAnimation(0, \"action\", false);\r\n    \r\n    this.scheduleOnce(() => {\r\n      this.Spine_PlayerPower.node.active = true;\r\n      this.Spine_PlayerPower.setAnimation(0, \"Evo02\", false);\r\n    }, 0.5)\r\n\r\n    this.scheduleOnce(() => {\r\n      this.callTween(collide, 2.2, 2);\r\n    }, 1.5)\r\n\r\n\r\n    this.scheduleOnce(() => {\r\n      this.isTransforming = false;\r\n      tween(this.Camera)\r\n        .to(1, { zoomRatio: 0.65 })\r\n        .start();\r\n    }, 2);\r\n  }\r\n\r\n\r\n  public handlePowerUpLv2(collide: Node, otherCollide: Node): void {\r\n    // this.JoyStick.node.opacity = 0;\r\n    this.touchArea.getComponent(\"TouchArea\").isTouched = false;\r\n    let spine = collide.getChildByName(\"Body\").getChildByName(\"Spine_Fish\").getComponent(sp.Skeleton);\r\n    spine.setAnimation(0, \"idle\", true);\r\n    this.isLevel2 = false;\r\n    this.isLevel3 = true;\r\n    this.isTransforming = true;\r\n    otherCollide.destroy();\r\n    this.touchArea.getComponent(\"TouchArea\").offEvent();\r\n    this.Spine_Bubble.node.active = true;\r\n    this.Spine_Bubble.setAnimation(0, \"action\", false);\r\n    \r\n    this.scheduleOnce(() => {\r\n      this.Spine_PlayerPower.node.active = true;\r\n      this.Spine_PlayerPower.setAnimation(0, \"Evo02\", false);\r\n    }, 0.5)\r\n\r\n    this.scheduleOnce(() => {\r\n      this.isTransforming = false;\r\n      this.callTween(collide, 4.2, 4);\r\n    }, 1.5)\r\n\r\n\r\n    this.scheduleOnce(() => {\r\n      this.Button_CTA.getComponent(Animation).play(\"Btn_CTAAnim\");\r\n      this.Hand_CTA.getComponent(Animation).play(\"Btn_HandAnim\");\r\n\r\n      tween(this.Camera)\r\n        .to(1, { zoomRatio: 0.3 })\r\n        .start();\r\n    }, 2);\r\n  }\r\n\r\n\r\n}\r\n"]}