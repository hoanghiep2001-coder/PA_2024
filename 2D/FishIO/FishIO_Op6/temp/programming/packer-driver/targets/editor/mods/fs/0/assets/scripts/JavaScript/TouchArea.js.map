{"version":3,"sources":["file:///D:/playable-ads-hiepdh/FishIO/FishIO_Op6/assets/scripts/JavaScript/TouchArea.js"],"names":["Constants","require","cc","Class","extends","Component","properties","positionTouch","Vec2","flag","isGameIntro","isEndGame","player","Node","camera","rigidBody","RigidBody","GameController","tut","gamePlay","JoyStick","Tut_Hand","hideMask","IRS_hideMask","PowerController","Btn_CTA","start","bodyPlayer","getChildByName","levelPlayer","playerFishSpine","getComponent","sp","Skeleton","isTouched","isPlayGame","registerEvent","Animation","play","on","EventType","TOUCH_START","handleIronSourcePlaySound","scheduleOnce","onToStore","installHandle","onHideMaskTouchStart","TOUCH_MOVE","moveWithTouch","TOUCH_CANCEL","onHideMaskTouchEnd","TOUCH_END","event","stop","active","opacity","isMove","setAnimation","stickStart","handleFixCircleCldFishes","isStartGame","stickEnd","offEvent","off","handleTransforming","isTransforming","console","log","isLevel3","getLocation","localTouchPos","node","convertToNodeSpaceAR","x","y","anglePlayer","misc","radiansToDegrees","Math","atan","angle","move","scaleX","handleCheckPlayerIsLv3","handleInstall","update","dt"],"mappings":"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","sourcesContent":["const { Constants } = require(\"../Data/Constant\");\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    positionTouch: cc.Vec2,\r\n    flag: false,\r\n    isGameIntro: false,\r\n    isEndGame: false,\r\n\r\n    player: cc.Node,\r\n    camera: cc.Node,\r\n    rigidBody: cc.RigidBody,\r\n    GameController: cc.Node,\r\n    tut: cc.Node,\r\n    gamePlay: cc.Node,\r\n\r\n    // Hiep Be\r\n    JoyStick: cc.Node,\r\n    Tut_Hand: cc.Node,\r\n    hideMask: cc.Node,\r\n    IRS_hideMask: cc.Node,\r\n    PowerController: cc.Node,\r\n    Btn_CTA: cc.Node,\r\n  },\r\n\r\n  start() {\r\n    this.bodyPlayer = this.player.getChildByName(\"Body\");\r\n    this.levelPlayer = this.player\r\n      .getChildByName(\"Body\")\r\n      .getChildByName(\"Level\");\r\n    this.playerFishSpine = this.bodyPlayer\r\n      .getChildByName(\"Spine_Fish\")\r\n      .getComponent(sp.Skeleton);\r\n    this.isTouched = false;\r\n    this.isPlayGame = false;\r\n\r\n    if (this.isGameIntro) {\r\n      this.registerEvent();\r\n      this.tut.getComponent(cc.Animation).play(\"Tut_ShowAnim\");\r\n    } else {\r\n      // ironsource\r\n      this.IRS_hideMask.on(\r\n        cc.Node.EventType.TOUCH_START,\r\n        () => {\r\n          this.GameController.getComponent(\r\n            \"GameController\"\r\n          ).handleIronSourcePlaySound();\r\n        },\r\n        this\r\n      );\r\n\r\n      this.scheduleOnce(() => {\r\n        this.registerEvent();\r\n        // this.onToStore();\r\n        this.tut.getComponent(cc.Animation).play(\"Tut_ShowAnim\");\r\n      }, 3);\r\n    }\r\n  },\r\n\r\n  onToStore() {\r\n    this.hideMask.on(\r\n      cc.Node.EventType.TOUCH_START,\r\n      () => {\r\n        this.GameController.getComponent(\"GameController\").installHandle();\r\n      },\r\n      this\r\n    );\r\n  },\r\n\r\n  registerEvent() {\r\n    this.hideMask.on(\r\n      cc.Node.EventType.TOUCH_START,\r\n      this.onHideMaskTouchStart,\r\n      this\r\n    );\r\n    this.hideMask.on(cc.Node.EventType.TOUCH_MOVE, this.moveWithTouch, this);\r\n    this.hideMask.on(\r\n      cc.Node.EventType.TOUCH_CANCEL,\r\n      this.onHideMaskTouchEnd,\r\n      this\r\n    );\r\n    this.hideMask.on(\r\n      cc.Node.EventType.TOUCH_END,\r\n      this.onHideMaskTouchEnd,\r\n      this\r\n    );\r\n  },\r\n\r\n  onHideMaskTouchStart(event) {\r\n    this.tut.getComponent(cc.Animation).stop(\"Tut_ShowAnim\");\r\n    if (this.tut.active) {\r\n      this.tut.opacity = 0;\r\n      this.player.getComponent(\"PlayerController\").isMove = true;\r\n    }\r\n\r\n    this.playerFishSpine.setAnimation(0, \"eat\", true);\r\n    this.isPlayGame = true;\r\n    this.isTouched = true;\r\n    this.JoyStick.opacity = 100;\r\n    this.JoyStick.getComponent(\"JoyStick\").stickStart(event);\r\n    this.JoyStick.getComponent(\"JoyStick\").handleFixCircleCldFishes();\r\n    this.GameController.getComponent(\"GameController\").isStartGame = false;\r\n  },\r\n\r\n  onHideMaskTouchEnd(event) {\r\n    this.playerFishSpine.setAnimation(0, \"idle\", true);\r\n    this.isTouched = false;\r\n    this.JoyStick.opacity = 0;\r\n    this.JoyStick.getComponent(\"JoyStick\").stickEnd(event);\r\n\r\n    this.scheduleOnce(() => {\r\n      if (this.isTouched) {\r\n        return;\r\n      }\r\n      this.tut.getComponent(cc.Animation).play(\"Tut_ShowAnim\");\r\n    }, 3);\r\n  },\r\n\r\n  offEvent() {\r\n    this.hideMask.off(cc.Node.EventType.TOUCH_START);\r\n    this.hideMask.off(cc.Node.EventType.TOUCH_MOVE);\r\n    this.hideMask.off(cc.Node.EventType.TOUCH_END);\r\n    this.hideMask.off(cc.Node.EventType.TOUCH_CANCEL);\r\n  },\r\n\r\n  handleTransforming() {\r\n    if (\r\n      this.PowerController.getComponent(\"PowerController\").isTransforming &&\r\n      !this.flag\r\n    ) {\r\n      this.flag = true;\r\n      this.offEvent();\r\n      console.log(\"off\");\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !this.PowerController.getComponent(\"PowerController\").isTransforming &&\r\n      this.flag &&\r\n      !this.PowerController.getComponent(\"PowerController\").isLevel3\r\n    ) {\r\n      this.flag = false;\r\n      this.registerEvent();\r\n      console.log(\"register\");\r\n      return;\r\n    }\r\n  },\r\n\r\n  moveWithTouch(event) {\r\n    this.JoyStick.getComponent(\"JoyStick\").stickStart(event);\r\n    this.positionTouch = event.getLocation();\r\n    let localTouchPos = this.node.convertToNodeSpaceAR(this.positionTouch);\r\n    this.positionTouch = localTouchPos;\r\n\r\n    this.positionTouch.x += this.camera.x;\r\n    this.positionTouch.y += this.camera.y;\r\n\r\n    var anglePlayer = cc.misc.radiansToDegrees(\r\n      Math.atan(\r\n        (this.player.y - localTouchPos.y) / (this.player.x - localTouchPos.x)\r\n      )\r\n    );\r\n\r\n    this.bodyPlayer.angle = anglePlayer;\r\n    this.player.getComponent(\"PlayerController\").move();\r\n\r\n    if (this.player.x - localTouchPos.x > 0) {\r\n      this.bodyPlayer.scaleX = 1;\r\n      this.levelPlayer.scaleX = 0.5;\r\n    } else {\r\n      this.bodyPlayer.scaleX = -1;\r\n      this.levelPlayer.scaleX = -0.5;\r\n    }\r\n  },\r\n\r\n  handleCheckPlayerIsLv3() {\r\n    if (this.player.getComponent(\"PlayerController\").isLevel3) {\r\n      this.tut.active = false;\r\n    }\r\n  },\r\n\r\n  handleInstall() {\r\n    if (\r\n      this.PowerController.getComponent(\"PowerController\").isLevel3 &&\r\n      !this.isEndGame\r\n    ) {\r\n      this.isEndGame = true;\r\n\r\n      // others\r\n      this.Btn_CTA.on(\r\n        cc.Node.EventType.TOUCH_START,\r\n        () => {\r\n          this.GameController.getComponent(\"GameController\").installHandle();\r\n        },\r\n        this\r\n      );\r\n\r\n      // mtg & applovin\r\n      // this.hideMask.on(cc.Node.EventType.TOUCH_START, () => {\r\n      //     this.GameController.getComponent(\"GameController\").installHandle();\r\n      // }, this)\r\n    }\r\n  },\r\n\r\n  update(dt) {\r\n    this.handleTransforming();\r\n    this.handleCheckPlayerIsLv3();\r\n    this.handleInstall();\r\n\r\n    // if (!this.player.getComponent(\"PlayerController\").isLive) {\r\n    //     this.hideMask.off(cc.Node.EventType.TOUCH_START);\r\n    //     this.hideMask.off(cc.Node.EventType.TOUCH_MOVE);\r\n    // }\r\n  },\r\n});\r\n"]}