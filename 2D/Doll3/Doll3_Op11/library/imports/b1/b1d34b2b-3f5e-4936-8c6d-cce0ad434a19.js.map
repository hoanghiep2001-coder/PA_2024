{"version":3,"sources":["assets\\Script\\Controller\\GamePlay.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAA8C;AAC9C,uDAAkD;AAClD,mDAAkD;AAClD,mDAA8C;AAExC,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAsC,4BAAY;IAAlD;QAAA,qEA+LC;QA5LC,kBAAY,GAAiB,IAAI,CAAC;QAElC,oBAAc,GAAmB,IAAI,CAAC;QAEtC,oBAAc,GAAmB,IAAI,CAAC;QAEtC,iBAAW,GAAW,CAAC,CAAC;QACxB,qBAAe,GAAW,CAAC,CAAC;;IAqL9B,CAAC;IAnLW,yBAAM,GAAhB;IAEA,CAAC;IAGS,wBAAK,GAAf;QACE,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QAClD,6DAA6D;QAC7D,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAGO,iCAAc,GAAtB;QACE,IAAI,CAAC,0BAA0B,EAAE,CAAC;IACpC,CAAC;IAGO,6CAA0B,GAAlC;QACE,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC;aACpC,aAAa,CACZ,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC;aACpC,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC;aACvB,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CACtD,CAAC,KAAK,EAAE,CAAC;IACd,CAAC;IAGM,8CAA2B,GAAlC;QACE,qBAAS,CAAC,eAAe,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;QAE7C,IAAG,qBAAS,CAAC,QAAQ,EAAE;YACrB,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC;iBACvC,aAAa,CACZ,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC;iBACrC,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;iBACxB,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CACrD,CAAC,KAAK,EAAE,CAAC;SACX;aAAM;YACL,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC;iBACvC,aAAa,CACZ,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC;iBACrC,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;iBACxB,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CACtD,CAAC,KAAK,EAAE,CAAC;SACX;IAEH,CAAC;IAGM,iCAAc,GAArB;QACE,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,aAAa,CAAC,CAAA;QAC/D,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,GAAG,GAAG,CAAC;QAC7C,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QAC/C,QAAQ,MAAM,EAAE;YACd,KAAK,CAAC;gBACJ,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAA;gBAC3D,MAAM;YACR,KAAK,CAAC;gBACJ,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAA;gBAC3D,MAAM;YACR,KAAK,CAAC;gBACJ,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAA;gBAC3D,MAAM;YACR,KAAK,CAAC;gBACJ,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAA;gBAC3D,MAAM;YACR;gBACE,MAAM;SACT;IACH,CAAC;IAGM,8BAAW,GAAlB;QACE,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QAChE,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;QAC7C,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC;QAC/C,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,MAAM,GAAG,KAAK,CAAC;QAEtC,IAAI,CAAC,yBAAyB,EAAE,CAAC;IACnC,CAAC;IAGM,6BAAU,GAAjB;QAAA,iBAkDC;QAjDC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QAChE,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,MAAM,GAAG,KAAK,CAAC;QACrD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;QACrC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,MAAM,GAAG,IAAI,CAAC;QACrC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,GAAG,qBAAS,CAAC,UAAU,CAAC,eAAe,CAAC;QACtE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAClC,qBAAS,CAAC,UAAU,CAAC,WAAW,EAChC,qBAAS,CAAC,UAAU,CAAC,WAAW,CAC/B,CAAA;QACH,0EAA0E;QAC1E,0EAA0E;QAC1E,IAAI,CAAC,YAAY,CAAC;YAChB,KAAI,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACjD,KAAI,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;YAC7C,KAAI,CAAC,cAAc,CAAC,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAExE,sBAAsB;YACtB,KAAI,CAAC,YAAY,CAAC;gBAAO,qBAAS,CAAC,gBAAgB,GAAG,KAAK,CAAA;gBACzD,qBAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC;YACpC,CAAC,EAAE,GAAG,CAAC,CAAA;YAEP,KAAI,CAAC,YAAY,CAAC,cAAO,qBAAS,CAAC,gBAAgB,GAAG,KAAK,CAAC,CAAA,CAAC,EAAE,GAAG,CAAC,CAAA;YACnE,KAAI,CAAC,YAAY,CAAC,cAAO,qBAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC,CAAA,CAAC,EAAE,GAAG,CAAC,CAAA;YAClE,KAAI,CAAC,YAAY,CAAC,cAAO,qBAAS,CAAC,gBAAgB,GAAG,KAAK,CAAC,CAAA,CAAC,EAAE,GAAG,CAAC,CAAA;YACnE,KAAI,CAAC,YAAY,CAAC,cAAO,qBAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC,CAAA,CAAC,EAAE,GAAG,CAAC,CAAA;YAElE,KAAI,CAAC,YAAY,CAAC;gBAChB,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC;gBACtC,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAEpE,EAAE,CAAC,KAAK,CAAC,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC;qBACpC,aAAa,CACZ,EAAE,CAAC,KAAK,CAAC,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC;qBAClC,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC;qBACvB,EAAE,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CACtD,CAAC,KAAK,EAAE,CAAC;gBAEV,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,KAAI,CAAC,cAAc,CAAC,aAAa,EAAE,KAAI,CAAC,CAAC;gBAEvG,iBAAiB;gBACjB,8GAA8G;YAChH,CAAC,EAAE,GAAG,CAAC,CAAA;QACT,CAAC,EAAE,CAAC,CAAC,CAAC;QAEN,IAAI,CAAC,YAAY,CAAC;YAChB,qBAAS,CAAC,gBAAgB,GAAG,KAAK,CAAC;YACnC,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAC5D,CAAC,EAAE,CAAC,CAAC,CAAC;IAER,CAAC;IAGM,4CAAyB,GAAhC;QACE,IAAI,qBAAS,CAAC,UAAU,CAAC,aAAa,EAAE;YACtC,OAAO;SACR;QAED,IAAI,qBAAS,CAAC,UAAU,CAAC,UAAU,EAAE;YACnC,qBAAS,CAAC,UAAU,CAAC,aAAa,GAAG,IAAI,CAAC;YAC1C,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;SAC3D;IAEH,CAAC;IAGO,4CAAyB,GAAjC;QACE,qBAAS,CAAC,UAAU,CAAC,KAAK,GAAG,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE,EAAE,CAAC,CAAA;QAElF,IAAI,qBAAS,CAAC,UAAU,CAAC,KAAK,EAAE;YAC9B,IAAI,qBAAS,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,qBAAS,CAAC,UAAU,CAAC,UAAU,IAAI,CAAC,qBAAS,CAAC,UAAU,CAAC,SAAS,EAAE;gBAC3G,qBAAS,CAAC,UAAU,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,qBAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;aAC3D;YAED,IAAI,qBAAS,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,IAAI,qBAAS,CAAC,UAAU,CAAC,UAAU,EAAE;gBACvE,qBAAS,CAAC,UAAU,CAAC,UAAU,GAAG,KAAK,CAAC;gBACxC,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC;aAClC;SACF;IACH,CAAC;IAGS,yBAAM,GAAhB,UAAiB,EAAU;QAEvB,IAAG,qBAAS,CAAC,gBAAgB,EAAE;YAC7B,IAAI,CAAC,WAAW,IAAI,GAAG,CAAC;YACxB,IAAI,CAAC,eAAe,IAAI,GAAG,CAAC;YAC5B,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,GAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,OAAI,CAAC;YAC3E,IAAI,CAAC,cAAc,CAAC,QAAQ;iBAC3B,cAAc,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,OAAI,CAAC;SACtG;QAED,IAAI,CAAC,yBAAyB,EAAE,CAAC;IACrC,CAAC;IA1LD;QADC,QAAQ,CAAC,sBAAY,CAAC;kDACW;IAElC;QADC,QAAQ,CAAC,wBAAc,CAAC;oDACa;IAEtC;QADC,QAAQ,CAAC,+BAAc,CAAC;oDACa;IAPnB,QAAQ;QAD5B,OAAO;OACa,QAAQ,CA+L5B;IAAD,eAAC;CA/LD,AA+LC,CA/LqC,EAAE,CAAC,SAAS,GA+LjD;kBA/LoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["import { Constants } from \"../Data/constants\";\r\nimport AudioManager from \"../Plugin/AudioManager\";\r\nimport { GameController } from \"./GameController\";\r\nimport NodesContainer from \"./NodesContainer\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GamePlay extends cc.Component {\r\n\r\n  @property(AudioManager)\r\n  AudioManager: AudioManager = null;\r\n  @property(NodesContainer)\r\n  NodesContainer: NodesContainer = null;\r\n  @property(GameController)\r\n  GameController: GameController = null;\r\n\r\n  dollPrecent: number = 0;\r\n  opponentPrecent: number = 0;\r\n\r\n  protected onLoad(): void {\r\n\r\n  }\r\n\r\n\r\n  protected start(): void {\r\n    this.NodesContainer.DollPoint.node.active = false;\r\n    // this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n    this.handleGamePlay();\r\n  }\r\n\r\n\r\n  private handleGamePlay(): void {\r\n    this.activeBlinkAnimForBtnStart();\r\n  }\r\n\r\n\r\n  private activeBlinkAnimForBtnStart(): void {\r\n    cc.tween(this.NodesContainer.Btn_Start)\r\n      .repeatForever(\r\n        cc.tween(this.NodesContainer.Btn_Start)\r\n          .to(0.5, { scale: 0.3 })\r\n          .to(0.5, { scale: 0.32 }, { easing: 'elasticOut' })\r\n      ).start();\r\n  }\r\n\r\n\r\n  public activeBlinkAnimForBtnSubmit(): void {\r\n    Constants.isShowBtnSubmit = true;\r\n    this.NodesContainer.Btn_Submit.active = true;\r\n\r\n    if(Constants.isRotate) {\r\n      cc.tween(this.NodesContainer.Btn_Submit)\r\n      .repeatForever(\r\n        cc.tween(this.NodesContainer.Btn_Submit)\r\n          .to(0.5, { scale: 0.45 })\r\n          .to(0.5, { scale: 0.4 }, { easing: 'elasticOut' })\r\n      ).start();\r\n    } else {\r\n      cc.tween(this.NodesContainer.Btn_Submit)\r\n      .repeatForever(\r\n        cc.tween(this.NodesContainer.Btn_Submit)\r\n          .to(0.5, { scale: 0.35 })\r\n          .to(0.5, { scale: 0.32 }, { easing: 'elasticOut' })\r\n      ).start();\r\n    }\r\n\r\n  }\r\n\r\n\r\n  public playGreatSound(): void {\r\n    this.AudioManager.playSound(Constants.SoundTrack.pickItemSound)\r\n    this.AudioManager.pickItemSound.volume = 0.5;\r\n    let random = Math.floor(Math.random() * 4) + 1;\r\n    switch (random) {\r\n      case 1:\r\n        this.AudioManager.playSound(Constants.SoundTrack.Fx_Bonus1)\r\n        break;\r\n      case 2:\r\n        this.AudioManager.playSound(Constants.SoundTrack.Fx_Bonus2)\r\n        break;\r\n      case 3:\r\n        this.AudioManager.playSound(Constants.SoundTrack.Fx_Bonus3)\r\n        break;\r\n      case 4:\r\n        this.AudioManager.playSound(Constants.SoundTrack.Fx_Bonus4)\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n\r\n  public goToDressUp(): void {\r\n    this.AudioManager.playSound(Constants.SoundTrack.pickItemSound);\r\n    this.NodesContainer.OpenScene.active = false;\r\n    this.NodesContainer.DressUpScene.active = true;\r\n    this.NodesContainer.BG.active = false;\r\n\r\n    this.handleIronSourcePlaySound();\r\n  }\r\n\r\n\r\n  public goToBattle(): void {\r\n    this.AudioManager.playSound(Constants.SoundTrack.pickItemSound);\r\n    this.NodesContainer.DressUp_Container.active = false;\r\n    this.NodesContainer.Doll.opacity = 0;\r\n    this.NodesContainer.BG.active = true;\r\n    this.NodesContainer.Doll.scale = Constants.Responsive.calculatedScale;\r\n    this.NodesContainer.Doll.setPosition(\r\n      Constants.Responsive.calculatedX, \r\n      Constants.Responsive.calculatedY\r\n      )\r\n    // !Constants.isRotate && this.NodesContainer.Doll.setPosition(-80, -140);\r\n    // Constants.isRotate && this.NodesContainer.Doll.setPosition(-180, -110);\r\n    this.scheduleOnce(() => {      \r\n      this.NodesContainer.DollPoint.node.active = true;\r\n      this.NodesContainer.DollPoint.string = `0 %`;\r\n      this.NodesContainer.UI.getComponent(cc.Animation).play(\"UI_ShowBattle\");\r\n\r\n      // caculate Doll Point\r\n      this.scheduleOnce(() => {Constants.isStartCalculate = false\r\n        Constants.isStartCalculate = true;\r\n      }, 0.5)\r\n\r\n      this.scheduleOnce(() => {Constants.isStartCalculate = false;}, 1.2)\r\n      this.scheduleOnce(() => {Constants.isStartCalculate = true;}, 1.6)\r\n      this.scheduleOnce(() => {Constants.isStartCalculate = false;}, 2.2)\r\n      this.scheduleOnce(() => {Constants.isStartCalculate = true;}, 2.4)\r\n\r\n      this.scheduleOnce(() => {\r\n        this.NodesContainer.CTA.active = true;\r\n        this.NodesContainer.CTA.getComponent(cc.Animation).play(\"CTA_Anim\");\r\n\r\n        cc.tween(this.NodesContainer.CTA_Btn)\r\n        .repeatForever(\r\n          cc.tween(this.NodesContainer.CTA_Btn)\r\n            .to(0.5, { scale: 0.5 })\r\n            .to(0.5, { scale: 0.53 }, { easing: 'elasticOut' })\r\n        ).start();\r\n\r\n        this.NodesContainer.CTA_Btn.on(cc.Node.EventType.TOUCH_START, this.GameController.installHandle, this);\r\n\r\n        // mtg & applovin\r\n        // this.NodesContainer.CTA_Overlay.on(cc.Node.EventType.TOUCH_START, this.GameController.installHandle, this);\r\n      }, 5.5)\r\n    }, 1);\r\n\r\n    this.scheduleOnce(() => {\r\n      Constants.isStartCalculate = false;\r\n      this.AudioManager.playSound(Constants.SoundTrack.Fx_Lose);\r\n    }, 4);\r\n\r\n  }\r\n\r\n\r\n  public handleIronSourcePlaySound(): void {\r\n    if (Constants.ironSource.isPlayBgSound) {\r\n      return;\r\n    }\r\n\r\n    if (Constants.ironSource.SoundState) {\r\n      Constants.ironSource.isPlayBgSound = true;\r\n      this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n    }\r\n\r\n  }\r\n\r\n\r\n  private handleMuteSoundIronSource(): void {\r\n    Constants.ironSource.State = parseInt(localStorage.getItem(\"cocosSoundState\"), 10)\r\n\r\n    if (Constants.ironSource.State) {\r\n      if (Constants.ironSource.State === 1 && !Constants.ironSource.SoundState && !Constants.ironSource.isEndGame) {\r\n        Constants.ironSource.SoundState = true;\r\n        this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n      }\r\n\r\n      if (Constants.ironSource.State === 2 && Constants.ironSource.SoundState) {\r\n        Constants.ironSource.SoundState = false;\r\n        this.AudioManager.stopAllSound();\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  protected update(dt: number): void {\r\n    \r\n      if(Constants.isStartCalculate) {\r\n        this.dollPrecent += 0.4;\r\n        this.opponentPrecent += 0.6;\r\n        this.NodesContainer.DollPoint.string = `${Math.floor(this.dollPrecent)} %`;\r\n        this.NodesContainer.Opponent\r\n        .getChildByName(\"DollPoint\").getComponent(cc.Label).string = `${Math.floor(this.opponentPrecent)} %`;\r\n      }\r\n\r\n      this.handleMuteSoundIronSource();\r\n  }\r\n\r\n}\r\n"]}