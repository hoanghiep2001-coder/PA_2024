{"version":3,"sources":["assets\\Script\\Controller\\GamePlay.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Constants } from \"../Data/constants\";\r\nimport AudioManager from \"../Plugin/AudioManager\";\r\nimport { GameController } from \"./GameController\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GamePlay extends cc.Component {\r\n\r\n    // Script\r\n    @property(AudioManager)\r\n    AudioManager: AudioManager = null;\r\n    @property(GameController)\r\n    GameController: GameController = null;\r\n\r\n\r\n    // Component\r\n    @property(cc.Graphics)\r\n    pencil: cc.Graphics = null;\r\n\r\n\r\n    // Node\r\n    @property(cc.Node)\r\n    Bg_HideMask: cc.Node = null;\r\n    @property(cc.Node)\r\n    logo: cc.Node = null;\r\n    @property(cc.Node)\r\n    point: cc.Node = null;\r\n    @property(cc.Node)\r\n    hint: cc.Node = null;\r\n    @property([cc.Node])\r\n    point_draws: cc.Node[] = [];\r\n    @property(cc.Node)\r\n    CTA: cc.Node = null;\r\n    @property(cc.Node)\r\n    CTA_logo: cc.Node = null;\r\n    @property(cc.Node)\r\n    CTA_overlay: cc.Node = null;\r\n    @property(cc.Node)\r\n    CTA_btn: cc.Node = null;\r\n    @property([cc.Node])\r\n    fireWorks: cc.Node[] = [];\r\n\r\n\r\n\r\n    // Effects\r\n    @property([cc.Node])\r\n    effect_Nodes: cc.Node[] = [];\r\n    @property([cc.ParticleSystem])\r\n    effect_FireWorks: cc.ParticleSystem[] = [];\r\n    @property([sp.Skeleton])\r\n    spine_FireWorks: sp.Skeleton[] = [];\r\n\r\n    // Lv3\r\n    @property(cc.Node)\r\n    spine_level3: cc.Node = null;\r\n    @property(cc.Node)\r\n    text_lv3: cc.Node = null;\r\n\r\n\r\n    // State\r\n    curentPosition: cc.Vec2 = null;\r\n    currentHint: cc.Node = null;\r\n    currentPencil: cc.Graphics = null;\r\n    curerntPoint: cc.Node = null;\r\n    currentHitPoints: cc.Node[] = [];\r\n    doneHitPoints: boolean[] = [false, false, false];\r\n\r\n\r\n    protected onLoad(): void {\r\n        this.CTA.active = false;\r\n        this.spine_FireWorks.forEach(fw => fw.node.active = false);\r\n    }\r\n\r\n\r\n    protected start(): void {\r\n        this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n        // this.setupLevel();\r\n        this.handleGamePlay();\r\n        Constants.isCanTouch = true;\r\n    }\r\n\r\n\r\n    private handleGamePlay(): void {\r\n        this.registerEvent();\r\n    }\r\n\r\n\r\n    private registerEvent(): void {\r\n        this.Bg_HideMask.on(cc.Node.EventType.TOUCH_START, this.handleBgTouchStart, this);\r\n        this.Bg_HideMask.on(cc.Node.EventType.TOUCH_MOVE, this.handleBgTouchMove, this);\r\n        this.Bg_HideMask.on(cc.Node.EventType.TOUCH_END, this.handleBgTouchEnd, this);\r\n        this.Bg_HideMask.on(cc.Node.EventType.TOUCH_CANCEL, this.handleBgTouchEnd, this);\r\n    }\r\n\r\n\r\n    private handleBgTouchStart(e: cc.Touch): void {\r\n        if (!Constants.isCanTouch) {\r\n            return;\r\n        }\r\n\r\n\r\n        if (Constants.currentLv === 3) {\r\n            this.GameController.installHandle();\r\n            return;\r\n        }\r\n\r\n\r\n        this.curentPosition = e.getLocation();\r\n        this.setupLevel();\r\n        this.currentHint.getComponent(cc.Animation).stop();\r\n        this.currentHint.active = false;\r\n        // this.currentHint.getComponent(cc.Animation).play(`Hand_AnimLv${Constants.currentLv}`)\r\n        this.curerntPoint.setPosition(this.setCurrentPointPos());\r\n        this.AudioManager.playSound(Constants.SoundTrack.drawSound);\r\n        this.AudioManager.drawSound.loop = true;\r\n\r\n        // this.handleIronSourcePlaySound();\r\n    }\r\n\r\n\r\n    private handleBgTouchMove(e: cc.Touch): void {\r\n        if (!Constants.isCanTouch) {\r\n            return;\r\n        }\r\n\r\n        this.currentPencil.moveTo(\r\n            this.curentPosition.x - cc.winSize.width / 2,\r\n            this.curentPosition.y - cc.winSize.height / 2 - Constants.Responsive.calculated\r\n        );\r\n        this.currentPencil.lineTo(\r\n            e.getLocation().x - cc.winSize.width / 2,\r\n            e.getLocation().y - cc.winSize.height / 2 - Constants.Responsive.calculated\r\n        );\r\n\r\n        this.curentPosition = e.getLocation();\r\n        this.currentPencil.stroke();\r\n        this.curerntPoint.setPosition(this.setCurrentPointPos());\r\n        this.handleIntersectPoints();\r\n    }\r\n\r\n\r\n    private handleBgTouchEnd(): void {\r\n        if (!Constants.isCanTouch) {\r\n            return;\r\n        }\r\n\r\n        this.currentPencil.clear();\r\n        this.AudioManager.stopSound(Constants.SoundTrack.drawSound);\r\n        let result = this.doneHitPoints.find(point => point === false);\r\n        let newResult = String(result);\r\n        newResult === \"false\" ? this.drawAgain() : this.drawSuccess();\r\n    }\r\n\r\n\r\n    private setupLevel(): void {\r\n        this.currentHint = this.hint;\r\n        this.currentPencil = this.pencil;\r\n        this.curerntPoint = this.point;\r\n        this.currentHitPoints = this.point_draws;\r\n    }\r\n\r\n\r\n    private setCurrentPointPos(): cc.Vec2 {\r\n        let result = new cc.Vec2(0, 0);\r\n        result.x = this.curentPosition.x - cc.winSize.width / 2;\r\n        result.y = (this.curentPosition.y - cc.winSize.height / 2) - Constants.Responsive.calculated;\r\n\r\n        return result;\r\n    }\r\n\r\n\r\n    private handleIntersectPoints(): void {\r\n        for (let i = 0; i < this.currentHitPoints.length; i++) {\r\n            let currentNode = this.currentHitPoints[i];\r\n            if (currentNode.getBoundingBox().intersects(this.curerntPoint.getBoundingBox())) {\r\n                for (let j = 0; j < this.doneHitPoints.length; j++) {\r\n                    if (!this.doneHitPoints[j]) {\r\n                        this.doneHitPoints[j] = true;\r\n                        this.currentHitPoints.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    private drawAgain(): void {\r\n        console.log(\"draw again\");\r\n        this.doneHitPoints[0] = false;\r\n        this.doneHitPoints[1] = false;\r\n        this.doneHitPoints[2] = false;\r\n    }\r\n\r\n\r\n    private drawSuccess(): void {\r\n        console.log(\"draw success\");\r\n        Constants.isCanTouch = false;\r\n        this.doneHitPoints[0] = false;\r\n        this.doneHitPoints[1] = false;\r\n        this.doneHitPoints[2] = false;\r\n\r\n        this.effect_FireWorks[0].resetSystem();\r\n        this.effect_FireWorks[1].resetSystem();\r\n\r\n        this.activeFireWorks();\r\n    }\r\n\r\n\r\n    private activeFireWorks(): void {\r\n        this.AudioManager.playSound(Constants.SoundTrack.fireworksSound);\r\n        this.AudioManager.fireworksSound.volume = 0.7;\r\n        this.fireWorks.forEach(fw => {\r\n            cc.tween(fw)\r\n                .to(1,\r\n                    {\r\n                        y: this.point_draws[3].y,\r\n                        scale: 0\r\n                    }\r\n                )\r\n                .start();\r\n        });\r\n\r\n\r\n        this.scheduleOnce(() => {\r\n            this.spine_FireWorks[0].node.active = true;\r\n            this.spine_FireWorks[3].node.active = true;\r\n            this.AudioManager.playSound(Constants.SoundTrack.successSound);\r\n        }, 1);\r\n\r\n        this.scheduleOnce(() => {\r\n            this.spine_FireWorks[1].node.active = true;\r\n            this.spine_FireWorks[4].node.active = true;\r\n        }, 1.5);\r\n\r\n        this.scheduleOnce(() => {\r\n            this.spine_FireWorks[2].node.active = true;\r\n            this.spine_FireWorks[5].node.active = true;\r\n            this.handleDoneLevel();\r\n        }, 2)\r\n    }\r\n\r\n\r\n    private handleDoneLevel(): void {\r\n        this.spine_level3.getComponent(sp.Skeleton).setAnimation(0, \"action\", true);\r\n        this.spine_level3.getParent().getComponent(cc.Animation).stop(\"Character_Anim\");\r\n        this.Bg_HideMask.off(cc.Node.EventType.TOUCH_START);\r\n        this.Bg_HideMask.off(cc.Node.EventType.TOUCH_MOVE);\r\n        this.Bg_HideMask.off(cc.Node.EventType.TOUCH_END);\r\n        this.Bg_HideMask.off(cc.Node.EventType.TOUCH_CANCEL);\r\n\r\n        this.scheduleOnce(() => {\r\n            Constants.isDrawSuccess = true;\r\n            this.CTA.active = true;\r\n            this.CTA_btn.on(cc.Node.EventType.TOUCH_START, this.GameController.installHandle, this);\r\n\r\n            // mtg & applovin\r\n            // this.CTA_overlay.on(cc.Node.EventType.TOUCH_START, this.GameController.installHandle, this);\r\n        }, 2)\r\n    }\r\n\r\n\r\n\r\n    \r\n    public handleIronSourcePlaySound(): void {\r\n        if (Constants.ironSource.isPlayBgSound) {\r\n          return;\r\n        }\r\n    \r\n        if (Constants.ironSource.SoundState) {\r\n          this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n        }\r\n    \r\n        Constants.ironSource.isPlayBgSound = true;\r\n      }\r\n\r\n\r\n      private handleMuteSoundIronSource(): void {\r\n        Constants.ironSource.State = parseInt(localStorage.getItem(\"cocosSoundState\"), 10)\r\n    \r\n        if (Constants.ironSource.State) {\r\n          if (Constants.ironSource.State === 1 && !Constants.ironSource.SoundState && !Constants.ironSource.isEndGame) {\r\n            Constants.ironSource.SoundState = true;\r\n            this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n          }\r\n    \r\n          if (Constants.ironSource.State === 2 && Constants.ironSource.SoundState) {\r\n            Constants.ironSource.SoundState = false;\r\n            this.AudioManager.stopAllSound();\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n\r\n    protected update(dt: number): void {\r\n            // this.handleMuteSoundIronSource();\r\n    }\r\n}\r\n"]}