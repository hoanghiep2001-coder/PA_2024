{"version":3,"sources":["assets\\Script\\Controller\\SpawnController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Constants } from \"../Data/constants\";\r\nimport Army from \"../Other/Army\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class SpawnController extends cc.Component {\r\n\r\n    @property([cc.Node])\r\n    AllyPoints: cc.Node[] = [];\r\n    @property([cc.Node])\r\n    EnemyPoints: cc.Node[] = [];\r\n\r\n    @property(cc.Prefab)\r\n    Army_Lv1: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    Army_Lv2: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    Army_Lv3: cc.Prefab = null;\r\n\r\n\r\n    @property(cc.Prefab)\r\n    Army2_Lv1: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    Army2_Lv2: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    Army2_Lv3: cc.Prefab = null;\r\n\r\n\r\n    enemySpawnTime: number = 4;\r\n\r\n\r\n    protected start(): void {\r\n        // if(Constants.enemyArmies[0]) Constants.enemyArmies.splice(0, 1);\r\n        // this.SpawnEnemyArmy(Constants.ArmySkin.Enemy);\r\n    }\r\n\r\n\r\n    public SpawnEnemies(): void {\r\n        this.schedule(function () {\r\n            if (Constants.isPauseGame) return;\r\n            this.SpawnEnemyArmy(Constants.ArmySkin.Enemy);\r\n        }, this.enemySpawnTime, cc.macro.REPEAT_FOREVER, 0.2);\r\n    }\r\n\r\n\r\n    public SpawnEnemyArmy(skin: string): void {\r\n\r\n        if((Constants.isCanBuyArmyLv3 || Constants.isUpgrade) && this.enemySpawnTime === 0.3) {\r\n            console.log(\"up spawn time\");\r\n            \r\n            this.enemySpawnTime = 1.5;\r\n        }\r\n\r\n        let random = cc.math.randomRangeInt(0, 3)\r\n\r\n        // create Army\r\n        let newArmy = cc.instantiate(this.Army_Lv1);\r\n        Constants.enemyArmies.push(newArmy);\r\n\r\n        // caculate Scale\r\n        newArmy.scaleX = -Constants.scaleArmy;\r\n        newArmy.scaleY = Constants.scaleArmy;\r\n\r\n        // set Pos\r\n        let point = this.EnemyPoints[random];\r\n        let armyComponent = newArmy.getComponent(Army);\r\n        point.parent.addChild(newArmy);\r\n        newArmy.setSiblingIndex(0);\r\n        newArmy.setPosition(point.getPosition());\r\n\r\n        // set skin & group\r\n        armyComponent.skin = skin;\r\n        newArmy.group = \"Enemy\";\r\n        let spine = newArmy.getChildByName(\"Spine\").getComponent(sp.Skeleton);\r\n        spine.setSkin(skin);\r\n        \r\n        // console.log(\"Enemy - Group: \" + newArmy.group);\r\n    }\r\n\r\n\r\n    public SpawnPlayerArmy(skin: string, level: number): void {\r\n        let random = cc.math.randomRangeInt(0, 3)\r\n        let newArmy: cc.Node;\r\n\r\n        if(!Constants.isUpgrade) {\r\n            switch (level) {\r\n                case 1:\r\n                    newArmy = cc.instantiate(this.Army_Lv1);\r\n                    break;\r\n                case 2:\r\n                    newArmy = cc.instantiate(this.Army_Lv2);\r\n                    break;\r\n                case 3:\r\n                    newArmy = cc.instantiate(this.Army_Lv3);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        } else {\r\n            switch (level) {\r\n                case 1:\r\n                    newArmy = cc.instantiate(this.Army2_Lv1);\r\n                    break;\r\n                case 2:\r\n                    newArmy = cc.instantiate(this.Army2_Lv2);\r\n                    break;\r\n                case 3:\r\n                    newArmy = cc.instantiate(this.Army2_Lv3);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        // create Army\r\n       \r\n\r\n        Constants.allyArmies.push(newArmy);\r\n        console.log(\"Allies:\" + Constants.allyArmies.length);\r\n\r\n        // caculate Scale\r\n        newArmy.scale = Constants.scaleArmy;\r\n\r\n        // set Pos\r\n        let point = this.AllyPoints[random];\r\n        let armyComponent = newArmy.getComponent(Army);\r\n        point.parent.addChild(newArmy);\r\n        newArmy.setSiblingIndex(0);\r\n        newArmy.setPosition(point.getPosition());\r\n\r\n        // set skin & group\r\n        armyComponent.skin = skin;\r\n        // armyComponent.tag = 1;\r\n        newArmy.group = \"Ally\";\r\n        let spine = newArmy.getChildByName(\"Spine\").getComponent(sp.Skeleton);\r\n        spine.setSkin(skin);\r\n        spine.timeScale = 0.9;\r\n    }\r\n\r\n\r\n}\r\n"]}