{"version":3,"sources":["assets\\Script\\Controller\\SpawnController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Constants } from \"../Data/constants\";\r\nimport Army from \"../Other/Army\";\r\n\r\nimport { RandomRangeInt } from \"../Data/Ultils\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class SpawnController extends cc.Component {\r\n    @property(cc.Node)\r\n    BasePlayer: cc.Node  = null;\r\n\r\n    @property([cc.Node])\r\n    AllyPoints: cc.Node[] = [];\r\n    @property([cc.Node])\r\n    EnemyPoints: cc.Node[] = [];\r\n\r\n    @property(cc.Prefab)\r\n    Army_Lv1: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    Army_Lv2: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    Army_Lv3: cc.Prefab = null;\r\n\r\n    enemySpawnTime: number = 1;\r\n\r\n    isReduce: boolean = false\r\n\r\n\r\n    protected start(): void {\r\n        // if(Constants.enemyArmies[0]) Constants.enemyArmies.splice(0, 1);\r\n        // this.SpawnEnemyArmy(Constants.ArmySkin.Enemy);\r\n\r\n        Constants.isUpgrade = true;\r\n\r\n        this.spawnTank();\r\n    }  \r\n    \r\n\r\n    private spawnTank(): void {\r\n        this.scheduleOnce(() => {\r\n            let random = 2;\r\n            let newArmy: cc.Node;\r\n            newArmy = cc.instantiate(this.Army_Lv3);\r\n            \r\n            Constants.allyArmies.push(newArmy);\r\n            \r\n            // caculate Scale\r\n            newArmy.scale = Constants.scaleArmy;\r\n            \r\n            // set Pos\r\n            let point = this.AllyPoints[random];\r\n            point.parent.addChild(newArmy);\r\n            newArmy.setSiblingIndex(0);\r\n            newArmy.setPosition(point.getPosition());\r\n            \r\n            // set skin & group\r\n            newArmy.group = \"Ally\";\r\n            let spine = newArmy.getChildByName(\"Spine\").getComponent(sp.Skeleton);\r\n            spine.timeScale = 0.9;\r\n            Constants.isSpawnTank = true;\r\n            \r\n            cc.log(\"Spawned Tank!\");\r\n        }, 0.5);\r\n    }\r\n\r\n\r\n    public SpawnEnemies(): void {\r\n        this.schedule(() => {\r\n            let random = RandomRangeInt(1, 3);\r\n            if (Constants.isPauseGame || Constants.shootCount >= 2) return;\r\n            this.SpawnEnemyArmy(Constants.ArmySkin.Enemy, random);\r\n        }, this.enemySpawnTime, cc.macro.REPEAT_FOREVER, 0.2);\r\n    }\r\n\r\n\r\n    public SpawnEnemyArmy(skin: string, level: number): void {\r\n\r\n        // if((Constants.isCanBuyArmyLv3 || Constants.isUpgrade) && this.enemySpawnTime === 0.3) {\r\n        //     console.log(\"up spawn time\");\r\n            \r\n        //     this.enemySpawnTime = 1.5;\r\n        // }\r\n\r\n        \r\n        let random = RandomRangeInt(0, 5)\r\n\r\n        // create Army\r\n        let newArmy: cc.Node = null;\r\n\r\n            switch (level) {\r\n                case 1:\r\n                    newArmy = cc.instantiate(this.Army_Lv1);\r\n                    break;\r\n                case 2:\r\n                    newArmy = cc.instantiate(this.Army_Lv2);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n\r\n        Constants.enemyArmies.push(newArmy);\r\n\r\n        // caculate Scale\r\n        newArmy.scaleX = -Constants.scaleArmy;\r\n        newArmy.scaleY = Constants.scaleArmy;\r\n\r\n        // set Pos\r\n        let point = this.EnemyPoints[random];\r\n        let armyComponent = newArmy.getComponent(Army);\r\n        point.parent.addChild(newArmy);\r\n        newArmy.setSiblingIndex(0);\r\n        newArmy.setPosition(point.getPosition());\r\n\r\n        // set skin & group\r\n        armyComponent.skin = skin;\r\n        newArmy.group = \"Enemy\";\r\n        let spine = newArmy.getChildByName(\"Spine\").getComponent(sp.Skeleton);\r\n        spine.setSkin(skin);\r\n        \r\n        console.log(\"Enemy - Group: \" + newArmy.group);\r\n    }\r\n\r\n\r\n    public SpawnPlayerArmy(skin: string, level: number): void {\r\n        let random = RandomRangeInt(0, 5)\r\n        let newArmy: cc.Node;\r\n\r\n            switch (level) {\r\n                case 1:\r\n                    newArmy = cc.instantiate(this.Army_Lv1);\r\n                    break;\r\n                case 2:\r\n                    newArmy = cc.instantiate(this.Army_Lv2);\r\n                    break;\r\n                case 3:\r\n                    newArmy = cc.instantiate(this.Army_Lv3);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        // create Army\r\n       \r\n        Constants.allyArmies.push(newArmy);\r\n        console.log(\"Allies:\" + Constants.allyArmies.length);\r\n\r\n        // caculate Scale\r\n        newArmy.scale = Constants.scaleArmy;\r\n\r\n        // set Pos\r\n        let point = this.AllyPoints[random];\r\n        let armyComponent = newArmy.getComponent(Army);\r\n        point.parent.addChild(newArmy);\r\n        // newArmy.setSiblingIndex(0);\r\n        newArmy.setPosition(point.getPosition());\r\n        \r\n\r\n        // set skin & group\r\n        armyComponent.skin = skin;\r\n        newArmy.group = \"Ally\";\r\n        let spine = newArmy.getChildByName(\"Spine\").getComponent(sp.Skeleton);\r\n        spine.setSkin(skin);\r\n        spine.timeScale = 0.9;\r\n    }\r\n}\r\n"]}