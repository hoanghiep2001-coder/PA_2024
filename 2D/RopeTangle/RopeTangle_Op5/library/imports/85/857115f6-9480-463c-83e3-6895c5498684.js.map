{"version":3,"sources":["assets\\Script\\Controller\\TouchAreaController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { Constants } from \"../Data/constants\";\r\nimport AudioManager from \"../Plugin/AudioManager\";\r\nimport { GameController } from \"./GameController\";\r\nimport GamePlay from \"./GamePlay\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class TouchAreaController extends cc.Component {\r\n\r\n  // Component\r\n  @property(AudioManager)\r\n  AudioManager: AudioManager = null;\r\n  @property(GameController)\r\n  GameController: GameController = null;\r\n  @property(GamePlay)\r\n  GamePlay: GamePlay = null;\r\n\r\n  @property(cc.Node)\r\n  background: cc.Node = null;\r\n  @property(cc.Node)\r\n  HideMask: cc.Node = null;\r\n  @property(cc.Node)\r\n  oneTap: cc.Node = null;\r\n  @property(cc.MouseJoint)\r\n  mouseJoint: cc.MouseJoint = null;\r\n\r\n  // horizontal\r\n  @property([cc.Node])\r\n  Knots: cc.Node[] = [];\r\n  @property([cc.Node])\r\n  Knots_2: cc.Node[] = [];\r\n  // @property([cc.Node])\r\n  // Knots_3: cc.Node[] = [];\r\n  @property([cc.Node])\r\n  Ropes: cc.Node[] = [];\r\n  @property([cc.MotorJoint])\r\n  motorJoints: cc.MotorJoint[] = [];\r\n\r\n\r\n  // vertical\r\n  @property([cc.Node])\r\n  Knots_Vtc: cc.Node[] = [];\r\n  @property([cc.Node])\r\n  Knots_2_Vtc: cc.Node[] = [];\r\n  // @property([cc.Node])\r\n  // Knots_3_Vtc: cc.Node[] = [];\r\n  @property([cc.Node])\r\n  Ropes_Vtc: cc.Node[] = [];\r\n  @property([cc.MotorJoint])\r\n  motorJoints_Vtc: cc.MotorJoint[] = [];\r\n\r\n  protected start() {\r\n    this.registerEvent();\r\n  }\r\n\r\n\r\n  private registerEvent(): void {\r\n    // onetap -----------------\r\n    this.HideMask.on(cc.Node.EventType.TOUCH_START, this.GameController.installHandle, this);\r\n    // mtg & applovin\r\n    // this.oneTap.on(cc.Node.EventType.TOUCH_START, this.GameController.installHandle, this);\r\n    // ---------------------------\r\n\r\n    // this.HideMask.on(cc.Node.EventType.TOUCH_START, this.ropeTouchStart, this);\r\n    // this.HideMask.on(cc.Node.EventType.TOUCH_END, this.ropeTouchEnd, this);\r\n    // this.HideMask.on(cc.Node.EventType.TOUCH_CANCEL, this.ropeTouchEnd, this);\r\n\r\n    // ironsource\r\n    // this.background.on(cc.Node.EventType.TOUCH_START, this.handleIronSourcePlaySound, this);\r\n  }\r\n\r\n\r\n  private ropeTouchStart(e: cc.Touch): void {\r\n    this.GamePlay.hints.forEach(hint => hint.active = false);\r\n    this.GamePlay.hints_Vtc.forEach(hint => hint.active = false);\r\n    if (Constants.step === 2 || !Constants.isCollideKnot1) {\r\n      this.GamePlay.hints[1].active = true;\r\n      this.GamePlay.hints_Vtc[1].active = true;\r\n      this.AudioManager.playSound(Constants.SoundTrack.ropeSound1);\r\n    }\r\n    this.handleIronSourcePlaySound();\r\n  }\r\n\r\n\r\n  private ropeTouchEnd(): void {\r\n\r\n    // rope 1\r\n    if (\r\n      (\r\n        this.Ropes[0].getBoundingBox().intersects(this.Knots[0].getBoundingBox())\r\n        || this.Ropes_Vtc[0].getBoundingBox().intersects(this.Knots_Vtc[0].getBoundingBox())\r\n      )\r\n      && !Constants.isCollideKnot1) {\r\n      Constants.isCollideKnot1 = true;\r\n      Constants.knot1Status = false;\r\n      Constants.knot4Status = false;\r\n      this.motorJoints[0].linearOffset = new cc.Vec2(50, 245);\r\n      this.motorJoints_Vtc[0].linearOffset = new cc.Vec2(43, 198);\r\n      this.scheduleOnce(() => {\r\n        this.motorJoints[0].destroy();\r\n        this.motorJoints_Vtc[0].destroy();\r\n      }, 0.5)\r\n      this.HideMask.width = 5000;\r\n      this.AudioManager.playSound(Constants.SoundTrack.ropeSound2);\r\n    }\r\n    // --------------------\r\n\r\n\r\n    // rope 2\r\n    if (\r\n      (\r\n        this.Ropes[1].getBoundingBox().intersects(this.Knots_2[0].getBoundingBox())\r\n        || this.Ropes_Vtc[1].getBoundingBox().intersects(this.Knots_2_Vtc[0].getBoundingBox())\r\n      )\r\n      && !Constants.isCollideKnot2) {\r\n      Constants.isCollideKnot2 = true;\r\n      this.motorJoints[1].linearOffset = new cc.Vec2(115, 245);\r\n      this.motorJoints_Vtc[1].linearOffset = new cc.Vec2(90, 198);\r\n      this.scheduleOnce(() => {\r\n        this.motorJoints[1].destroy();\r\n        this.motorJoints[2].destroy();\r\n\r\n        this.motorJoints_Vtc[1].destroy();\r\n        this.motorJoints_Vtc[2].destroy();\r\n        this.AudioManager.playSound(Constants.SoundTrack.ropeSound2);\r\n      }, 0.5);\r\n    }\r\n\r\n    // if(this.Ropes[1].getBoundingBox().intersects(this.Knots_2[1].getBoundingBox()) && !Constants.knot2Status) {\r\n    //   this.motorJoints[1].linearOffset = new cc.Vec2(45, 198);\r\n    // }\r\n\r\n    // if(this.Ropes[1].getBoundingBox().intersects(this.Knots_2[2].getBoundingBox())) {\r\n    //   Constants.knot3Status = true;\r\n    //   this.motorJoints[1].linearOffset = new cc.Vec2(0, 198);\r\n    // }\r\n\r\n    // if(this.Ropes[1].getBoundingBox().intersects(this.Knots_2[3].getBoundingBox())) {\r\n    //   this.motorJoints[1].linearOffset = new cc.Vec2(-45, 198);\r\n    // }\r\n\r\n    // if(this.Ropes[1].getBoundingBox().intersects(this.Knots_2[4].getBoundingBox())) {\r\n    //   this.motorJoints[1].linearOffset = new cc.Vec2(-92, 198);\r\n    // }\r\n\r\n    // --------------------\r\n\r\n\r\n    // rope 3\r\n    // if(this.Ropes[2].getBoundingBox().intersects(this.Knots_3[0].getBoundingBox())) {\r\n    //   this.motorJoints[2].linearOffset = new cc.Vec2(128, 185);\r\n    // }\r\n\r\n    // if(this.Ropes[2].getBoundingBox().intersects(this.Knots_3[1].getBoundingBox())) {\r\n    //   this.motorJoints[2].linearOffset = new cc.Vec2(85, 185);\r\n    // }\r\n    // --------------------\r\n  }\r\n\r\n\r\n  public handleIronSourcePlaySound(): void {\r\n    if (Constants.ironSource.isPlayBgSound) {\r\n      return;\r\n    }\r\n\r\n    if (Constants.ironSource.SoundState) {\r\n      this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n    }\r\n\r\n    Constants.ironSource.isPlayBgSound = true;\r\n  }\r\n\r\n\r\n  private handleMuteSoundIronSource(): void {\r\n    Constants.ironSource.State = parseInt(localStorage.getItem(\"cocosSoundState\"), 10)\r\n\r\n    if (Constants.ironSource.State) {\r\n      if (Constants.ironSource.State === 1 && !Constants.ironSource.SoundState && !Constants.ironSource.isEndGame) {\r\n        Constants.ironSource.SoundState = true;\r\n        this.AudioManager.playSound(Constants.SoundTrack.bgSound);\r\n      }\r\n\r\n      if (Constants.ironSource.State === 2 && Constants.ironSource.SoundState) {\r\n        Constants.ironSource.SoundState = false;\r\n        this.AudioManager.stopAllSound();\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n  protected update(dt: number): void {\r\n    // this.handleMuteSoundIronSource();\r\n  }\r\n}\r\n"]}