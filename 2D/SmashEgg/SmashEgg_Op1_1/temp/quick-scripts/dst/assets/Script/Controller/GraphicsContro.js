
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Controller/GraphicsContro.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '93044ZctVJBYpcfVaP3IJVr', 'GraphicsContro');
// Script/Controller/GraphicsContro.js

"use strict";

var _StateForJS = require("../Data/StateForJS");

cc.Class({
  "extends": cc.Component,
  properties: {
    graphics: null,
    line_point: [cc.Vec2],
    isCanDraw: true
  },
  onLoad: function onLoad() {
    this.node.width = 320;
    this.node.height = 480;
    this.graphics = this.getComponent(cc.Graphics);
  },
  start: function start() {
    // StateForJs.isCanDraw = true;
    window.PointPos = cc.v2(-50, 100);
    window.isLineStop = false;
    this.isActiveLineLogic = false;
    this.onTouch();
  },
  update: function update() {
    if (this.rigibodyLogic && this.isActiveLineLogic) {
      if (this.rigibodyLogic.linearVelocity.x === 0 && this.rigibodyLogic.linearVelocity.y === 0) {
        window.isLineStop = true;
      }
    }
  },
  onTouch: function onTouch() {
    this.node.on(cc.Node.EventType.TOUCH_START, this.touch_start, this);
    this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touch_move, this);
    this.node.on(cc.Node.EventType.TOUCH_END, this.touch_end, this);
    this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.touch_end, this);
  },
  offTouch: function offTouch() {
    this.node.off(cc.Node.EventType.TOUCH_START);
    this.node.off(cc.Node.EventType.TOUCH_MOVE);
    this.node.off(cc.Node.EventType.TOUCH_END);
    this.node.off(cc.Node.EventType.TOUCH_CANCEL);
  },
  touch_start: function touch_start(event) {
    if (!this.isCanDraw || window.isWin) {
      return;
    }

    var pos = this.node.convertToNodeSpaceAR(event.getLocation());
    window.isStartDraw = true;
    window.PointPos = pos;
    this.graphics.moveTo(pos.x, pos.y);
    this.line_point.push(cc.v2(pos.x, pos.y));
  },
  touch_move: function touch_move(event) {
    if (!this.isCanDraw || window.isWin) {
      return;
    }

    var pos = this.node.convertToNodeSpaceAR(event.getLocation());
    window.PointPos = pos;
    this.graphics.lineTo(pos.x, pos.y);
    this.line_point.push(cc.v2(pos.x, pos.y));

    if (window.isTouchWall) {
      this.graphics.strokeColor = cc.Color.RED;
    } else {
      this.graphics.strokeColor = cc.Color.BLACK;
    }

    this.graphics.stroke();
  },
  touch_end: function touch_end(event) {
    if (window.isTouchWall) {
      _StateForJS.StateForJs.isCanDraw = true;
      window.isTouchWall = false;
      this.line_point = [];
      this.graphics.clear();
      return;
    }

    if (!this.isCanDraw || window.isWin) {
      return;
    }

    this.isCanDraw = false;
    window.isDraw = true;
    window.isTouchWall = false;
    this.createRigibody();
    this.offTouch();
  },
  createRigibody: function createRigibody() {
    var _this = this;

    this.rigibodyLogic = this.addComponent(cc.RigidBody);
    this.rigibodyLogic.gravityScale = 2;
    this.physicsLine = this.addComponent("MyPhysicsCollider");
    this.physicsLine.lineWidth = 9;
    this.physicsLine.points = this.line_point;
    this.physicsLine.friction = 0;
    this.physicsLine.density = 100000000;
    this.physicsLine.tag = 5;
    this.physicsLine.apply();
    this.scheduleOnce(function () {
      _this.isActiveLineLogic = true;
    }, 0.3);
  },
  checkIsCanDraw: function checkIsCanDraw(lastPoint, nowPoint) {
    return lastPoint.sub(nowPoint).mag() >= 20;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxDb250cm9sbGVyXFxHcmFwaGljc0NvbnRyby5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImdyYXBoaWNzIiwibGluZV9wb2ludCIsIlZlYzIiLCJpc0NhbkRyYXciLCJvbkxvYWQiLCJub2RlIiwid2lkdGgiLCJoZWlnaHQiLCJnZXRDb21wb25lbnQiLCJHcmFwaGljcyIsInN0YXJ0Iiwid2luZG93IiwiUG9pbnRQb3MiLCJ2MiIsImlzTGluZVN0b3AiLCJpc0FjdGl2ZUxpbmVMb2dpYyIsIm9uVG91Y2giLCJ1cGRhdGUiLCJyaWdpYm9keUxvZ2ljIiwibGluZWFyVmVsb2NpdHkiLCJ4IiwieSIsIm9uIiwiTm9kZSIsIkV2ZW50VHlwZSIsIlRPVUNIX1NUQVJUIiwidG91Y2hfc3RhcnQiLCJUT1VDSF9NT1ZFIiwidG91Y2hfbW92ZSIsIlRPVUNIX0VORCIsInRvdWNoX2VuZCIsIlRPVUNIX0NBTkNFTCIsIm9mZlRvdWNoIiwib2ZmIiwiZXZlbnQiLCJpc1dpbiIsInBvcyIsImNvbnZlcnRUb05vZGVTcGFjZUFSIiwiZ2V0TG9jYXRpb24iLCJpc1N0YXJ0RHJhdyIsIm1vdmVUbyIsInB1c2giLCJsaW5lVG8iLCJpc1RvdWNoV2FsbCIsInN0cm9rZUNvbG9yIiwiQ29sb3IiLCJSRUQiLCJCTEFDSyIsInN0cm9rZSIsIlN0YXRlRm9ySnMiLCJjbGVhciIsImlzRHJhdyIsImNyZWF0ZVJpZ2lib2R5IiwiYWRkQ29tcG9uZW50IiwiUmlnaWRCb2R5IiwiZ3Jhdml0eVNjYWxlIiwicGh5c2ljc0xpbmUiLCJsaW5lV2lkdGgiLCJwb2ludHMiLCJmcmljdGlvbiIsImRlbnNpdHkiLCJ0YWciLCJhcHBseSIsInNjaGVkdWxlT25jZSIsImNoZWNrSXNDYW5EcmF3IiwibGFzdFBvaW50Iiwibm93UG9pbnQiLCJzdWIiLCJtYWciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7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R0FBakIsR0FBdUIsQ0FBdkI7QUFDQSxTQUFLTCxXQUFMLENBQWlCTSxLQUFqQjtBQUVBLFNBQUtDLFlBQUwsQ0FBa0IsWUFBTTtBQUNwQixNQUFBLEtBQUksQ0FBQ2hELGlCQUFMLEdBQXlCLElBQXpCO0FBQ0gsS0FGRCxFQUVHLEdBRkg7QUFHSCxHQS9HSTtBQWlITGlELEVBQUFBLGNBQWMsRUFBRSx3QkFBVUMsU0FBVixFQUFxQkMsUUFBckIsRUFBK0I7QUFDM0MsV0FBT0QsU0FBUyxDQUFDRSxHQUFWLENBQWNELFFBQWQsRUFBd0JFLEdBQXhCLE1BQWlDLEVBQXhDO0FBQ0g7QUFuSEksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3RhdGVGb3JKcyB9IGZyb20gXCIuLi9EYXRhL1N0YXRlRm9ySlNcIjtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBncmFwaGljczogbnVsbCxcclxuICAgICAgICBsaW5lX3BvaW50OiBbY2MuVmVjMl0sXHJcbiAgICAgICAgaXNDYW5EcmF3OiB0cnVlLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLndpZHRoID0gMzIwO1xyXG4gICAgICAgIHRoaXMubm9kZS5oZWlnaHQgPSA0ODA7XHJcbiAgICAgICAgdGhpcy5ncmFwaGljcyA9IHRoaXMuZ2V0Q29tcG9uZW50KGNjLkdyYXBoaWNzKTtcclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQoKSB7XHJcblxyXG5cclxuICAgICAgICAvLyBTdGF0ZUZvckpzLmlzQ2FuRHJhdyA9IHRydWU7XHJcbiAgICAgICAgd2luZG93LlBvaW50UG9zID0gY2MudjIoLTUwLDEwMCk7XHJcbiAgICAgICAgd2luZG93LmlzTGluZVN0b3AgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzQWN0aXZlTGluZUxvZ2ljID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5vblRvdWNoKCk7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICB1cGRhdGUoKSB7XHJcbiAgICAgICAgaWYodGhpcy5yaWdpYm9keUxvZ2ljICYmIHRoaXMuaXNBY3RpdmVMaW5lTG9naWMpIHtcclxuICAgICAgICAgICAgaWYodGhpcy5yaWdpYm9keUxvZ2ljLmxpbmVhclZlbG9jaXR5LnggPT09IDAgJiYgdGhpcy5yaWdpYm9keUxvZ2ljLmxpbmVhclZlbG9jaXR5LnkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5pc0xpbmVTdG9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG5cclxuICAgIG9uVG91Y2goKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLnRvdWNoX3N0YXJ0LCB0aGlzKTtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSwgdGhpcy50b3VjaF9tb3ZlLCB0aGlzKTtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLnRvdWNoX2VuZCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCwgdGhpcy50b3VjaF9lbmQsIHRoaXMpO1xyXG4gICAgfSxcclxuICAgIG9mZlRvdWNoKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5vZmYoY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vZmYoY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vZmYoY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMKTtcclxuICAgIH0sXHJcbiAgICB0b3VjaF9zdGFydDogZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQ2FuRHJhdyB8fCB3aW5kb3cuaXNXaW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHBvcyA9IHRoaXMubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihldmVudC5nZXRMb2NhdGlvbigpKTtcclxuICAgICAgICB3aW5kb3cuaXNTdGFydERyYXcgPSB0cnVlO1xyXG4gICAgICAgIHdpbmRvdy5Qb2ludFBvcyA9IHBvcztcclxuICAgICAgICB0aGlzLmdyYXBoaWNzLm1vdmVUbyhwb3MueCwgcG9zLnkpO1xyXG4gICAgICAgIHRoaXMubGluZV9wb2ludC5wdXNoKGNjLnYyKHBvcy54LCBwb3MueSkpO1xyXG4gICAgfSxcclxuICAgIHRvdWNoX21vdmU6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0NhbkRyYXcgfHwgd2luZG93LmlzV2luKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBwb3MgPSB0aGlzLm5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIoZXZlbnQuZ2V0TG9jYXRpb24oKSk7XHJcbiAgICAgICAgd2luZG93LlBvaW50UG9zID0gcG9zO1xyXG4gICAgICAgIHRoaXMuZ3JhcGhpY3MubGluZVRvKHBvcy54LCBwb3MueSk7XHJcbiAgICAgICAgdGhpcy5saW5lX3BvaW50LnB1c2goY2MudjIocG9zLngsIHBvcy55KSk7XHJcblxyXG4gICAgICAgIGlmKHdpbmRvdy5pc1RvdWNoV2FsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZUNvbG9yID0gY2MuQ29sb3IuUkVEXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5ncmFwaGljcy5zdHJva2VDb2xvciA9IGNjLkNvbG9yLkJMQUNLXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZSgpO1xyXG4gICAgfSxcclxuICAgIHRvdWNoX2VuZDogZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgaWYod2luZG93LmlzVG91Y2hXYWxsKSB7XHJcbiAgICAgICAgICAgIFN0YXRlRm9ySnMuaXNDYW5EcmF3ID0gdHJ1ZTtcclxuICAgICAgICAgICAgd2luZG93LmlzVG91Y2hXYWxsID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMubGluZV9wb2ludCA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5pc0NhbkRyYXcgfHwgd2luZG93LmlzV2luKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuaXNDYW5EcmF3ID0gZmFsc2U7XHJcbiAgICAgICAgd2luZG93LmlzRHJhdyA9IHRydWU7XHJcbiAgICAgICAgd2luZG93LmlzVG91Y2hXYWxsID0gZmFsc2VcclxuICAgICAgICB0aGlzLmNyZWF0ZVJpZ2lib2R5KCk7XHJcbiAgICAgICAgdGhpcy5vZmZUb3VjaCgpO1xyXG4gICAgfSxcclxuICAgIGNyZWF0ZVJpZ2lib2R5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5yaWdpYm9keUxvZ2ljID0gdGhpcy5hZGRDb21wb25lbnQoY2MuUmlnaWRCb2R5KTtcclxuICAgICAgICB0aGlzLnJpZ2lib2R5TG9naWMuZ3Jhdml0eVNjYWxlID0gMjtcclxuXHJcbiAgICAgICAgdGhpcy5waHlzaWNzTGluZSA9IHRoaXMuYWRkQ29tcG9uZW50KFwiTXlQaHlzaWNzQ29sbGlkZXJcIik7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzTGluZS5saW5lV2lkdGggPSA5O1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUucG9pbnRzID0gdGhpcy5saW5lX3BvaW50O1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUuZnJpY3Rpb24gPSAwO1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUuZGVuc2l0eSA9IDEwMDAwMDAwMDtcclxuICAgICAgICB0aGlzLnBoeXNpY3NMaW5lLnRhZyA9IDU7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzTGluZS5hcHBseSgpO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBY3RpdmVMaW5lTG9naWMgPSB0cnVlO1xyXG4gICAgICAgIH0sIDAuMyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNoZWNrSXNDYW5EcmF3OiBmdW5jdGlvbiAobGFzdFBvaW50LCBub3dQb2ludCkge1xyXG4gICAgICAgIHJldHVybiBsYXN0UG9pbnQuc3ViKG5vd1BvaW50KS5tYWcoKSA+PSAyMDtcclxuICAgIH0sXHJcblxyXG59KTtcclxuIl19