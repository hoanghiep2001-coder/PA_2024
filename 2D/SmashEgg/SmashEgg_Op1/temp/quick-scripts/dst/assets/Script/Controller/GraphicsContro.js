
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Controller/GraphicsContro.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '93044ZctVJBYpcfVaP3IJVr', 'GraphicsContro');
// Script/Controller/GraphicsContro.js

"use strict";

var _StateForJS = require("../Data/StateForJS");

cc.Class({
  "extends": cc.Component,
  properties: {
    graphics: null,
    line_point: [cc.Vec2],
    isCanDraw: true
  },
  onLoad: function onLoad() {
    this.node.width = 320;
    this.node.height = 480;
    this.graphics = this.getComponent(cc.Graphics);
  },
  start: function start() {
    // StateForJs.isCanDraw = true;
    window.PointPos = cc.v2(-50, 100);
    window.isLineStop = false;
    this.isActiveLineLogic = false;
    this.onTouch();
  },
  update: function update() {
    if (this.rigibodyLogic && this.isActiveLineLogic) {
      if (this.rigibodyLogic.linearVelocity.x === 0 && this.rigibodyLogic.linearVelocity.y === 0) {
        window.isLineStop = true;
      }
    }
  },
  onTouch: function onTouch() {
    this.node.on(cc.Node.EventType.TOUCH_START, this.touch_start, this);
    this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touch_move, this);
    this.node.on(cc.Node.EventType.TOUCH_END, this.touch_end, this);
    this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.touch_end, this);
  },
  offTouch: function offTouch() {
    this.node.off(cc.Node.EventType.TOUCH_START);
    this.node.off(cc.Node.EventType.TOUCH_MOVE);
    this.node.off(cc.Node.EventType.TOUCH_END);
    this.node.off(cc.Node.EventType.TOUCH_CANCEL);
  },
  touch_start: function touch_start(event) {
    if (!this.isCanDraw || window.isWin) {
      return;
    }

    var pos = this.node.convertToNodeSpaceAR(event.getLocation());
    window.isStartDraw = true;
    window.PointPos = pos;
    this.graphics.moveTo(pos.x, pos.y);
    this.line_point.push(cc.v2(pos.x, pos.y));
  },
  touch_move: function touch_move(event) {
    if (!this.isCanDraw || window.isWin) {
      return;
    }

    var pos = this.node.convertToNodeSpaceAR(event.getLocation());
    window.PointPos = pos;
    this.graphics.lineTo(pos.x, pos.y);
    this.line_point.push(cc.v2(pos.x, pos.y));

    if (window.isTouchWall) {
      this.graphics.strokeColor = cc.Color.RED;
    } else {
      this.graphics.strokeColor = cc.Color.BLACK;
    }

    this.graphics.stroke();
  },
  touch_end: function touch_end(event) {
    if (window.isTouchWall) {
      _StateForJS.StateForJs.isCanDraw = true;
      window.isTouchWall = false;
      this.line_point = [];
      this.graphics.clear();
      return;
    }

    if (!this.isCanDraw || window.isWin) {
      return;
    }

    this.isCanDraw = false;
    window.isDraw = true;
    window.isTouchWall = false;
    this.createRigibody();
    this.offTouch();
  },
  createRigibody: function createRigibody() {
    var _this = this;

    this.rigibodyLogic = this.addComponent(cc.RigidBody);
    this.rigibodyLogic.gravityScale = 10;
    this.physicsLine = this.addComponent("MyPhysicsCollider");
    this.physicsLine.lineWidth = 9;
    this.physicsLine.points = this.line_point;
    this.physicsLine.friction = 0;
    this.physicsLine.density = 0;
    this.physicsLine.tag = 5;
    this.physicsLine.apply();
    this.scheduleOnce(function () {
      _this.isActiveLineLogic = true;
    }, 0.3);
  },
  applyContact: function applyContact() {
    this.rigibodyLogic.onBeginContact = function (c, s, o) {};
  },
  checkIsCanDraw: function checkIsCanDraw(lastPoint, nowPoint) {
    return lastPoint.sub(nowPoint).mag() >= 20;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxDb250cm9sbGVyXFxHcmFwaGljc0NvbnRyby5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImdyYXBoaWNzIiwibGluZV9wb2ludCIsIlZlYzIiLCJpc0NhbkRyYXciLCJvbkxvYWQiLCJub2RlIiwid2lkdGgiLCJoZWlnaHQiLCJnZXRDb21wb25lbnQiLCJHcmFwaGljcyIsInN0YXJ0Iiwid2luZG93IiwiUG9pbnRQb3MiLCJ2MiIsImlzTGluZVN0b3AiLCJpc0FjdGl2ZUxpbmVMb2dpYyIsIm9uVG91Y2giLCJ1cGRhdGUiLCJyaWdpYm9keUxvZ2ljIiwibGluZWFyVmVsb2NpdHkiLCJ4IiwieSIsIm9uIiwiTm9kZSIsIkV2ZW50VHlwZSIsIlRPVUNIX1NUQVJUIiwidG91Y2hfc3RhcnQiLCJUT1VDSF9NT1ZFIiwidG91Y2hfbW92ZSIsIlRPVUNIX0VORCIsInRvdWNoX2VuZCIsIlRPVUNIX0NBTkNFTCIsIm9mZlRvdWNoIiwib2ZmIiwiZXZlbnQiLCJpc1dpbiIsInBvcyIsImNvbnZlcnRUb05vZGVTcGFjZUFSIiwiZ2V0TG9jYXRpb24iLCJpc1N0YXJ0RHJhdyIsIm1vdmVUbyIsInB1c2giLCJsaW5lVG8iLCJpc1RvdWNoV2FsbCIsInN0cm9rZUNvbG9yIiwiQ29sb3IiLCJSRUQiLCJCTEFDSyIsInN0cm9rZSIsIlN0YXRlRm9ySnMiLCJjbGVhciIsImlzRHJhdyIsImNyZWF0ZVJpZ2lib2R5IiwiYWRkQ29tcG9uZW50IiwiUmlnaWRCb2R5IiwiZ3Jhdml0eVNjYWxlIiwicGh5c2ljc0xpbmUiLCJsaW5lV2lkdGgiLCJwb2ludHMiLCJmcmljdGlvbiIsImRlbnNpdHkiLCJ0YWciLCJhcHBseSIsInNjaGVkdWxlT25jZSIsImFwcGx5Q29udGFjdCIsIm9uQmVnaW5Db250YWN0IiwiYyIsInMiLCJvIiwiY2hlY2tJc0NhbkRyYXciLCJsYXN0UG9pbnQiLCJub3dQb2ludCIsInN1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QkksT0FBakIsR0FBMkIsQ0FBM0I7QUFDQSxTQUFLSixXQUFMLENBQWlCSyxHQUFqQixHQUF1QixDQUF2QjtBQUNBLFNBQUtMLFdBQUwsQ0FBaUJNLEtBQWpCO0FBRUEsU0FBS0MsWUFBTCxDQUFrQixZQUFNO0FBQ3BCLE1BQUEsS0FBSSxDQUFDaEQsaUJBQUwsR0FBeUIsSUFBekI7QUFDSCxLQUZELEVBRUcsR0FGSDtBQUdILEdBL0dJO0FBa0hMaUQsRUFBQUEsWUFsSEssMEJBa0hVO0FBQ1gsU0FBSzlDLGFBQUwsQ0FBbUIrQyxjQUFuQixHQUFvQyxVQUFDQyxDQUFELEVBQUdDLENBQUgsRUFBS0MsQ0FBTCxFQUFXLENBRTlDLENBRkQ7QUFHSCxHQXRISTtBQXlITEMsRUFBQUEsY0FBYyxFQUFFLHdCQUFVQyxTQUFWLEVBQXFCQyxRQUFyQixFQUErQjtBQUMzQyxXQUFPRCxTQUFTLENBQUNFLEdBQVYsQ0FBY0QsUUFBZCxFQUF3QkUsR0FBeEIsTUFBaUMsRUFBeEM7QUFDSDtBQTNISSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTdGF0ZUZvckpzIH0gZnJvbSBcIi4uL0RhdGEvU3RhdGVGb3JKU1wiO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGdyYXBoaWNzOiBudWxsLFxyXG4gICAgICAgIGxpbmVfcG9pbnQ6IFtjYy5WZWMyXSxcclxuICAgICAgICBpc0NhbkRyYXc6IHRydWUsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLm5vZGUud2lkdGggPSAzMjA7XHJcbiAgICAgICAgdGhpcy5ub2RlLmhlaWdodCA9IDQ4MDtcclxuICAgICAgICB0aGlzLmdyYXBoaWNzID0gdGhpcy5nZXRDb21wb25lbnQoY2MuR3JhcGhpY3MpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydCgpIHtcclxuXHJcblxyXG4gICAgICAgIC8vIFN0YXRlRm9ySnMuaXNDYW5EcmF3ID0gdHJ1ZTtcclxuICAgICAgICB3aW5kb3cuUG9pbnRQb3MgPSBjYy52MigtNTAsMTAwKTtcclxuICAgICAgICB3aW5kb3cuaXNMaW5lU3RvcCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmVMaW5lTG9naWMgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9uVG91Y2goKTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIHVwZGF0ZSgpIHtcclxuICAgICAgICBpZih0aGlzLnJpZ2lib2R5TG9naWMgJiYgdGhpcy5pc0FjdGl2ZUxpbmVMb2dpYykge1xyXG4gICAgICAgICAgICBpZih0aGlzLnJpZ2lib2R5TG9naWMubGluZWFyVmVsb2NpdHkueCA9PT0gMCAmJiB0aGlzLnJpZ2lib2R5TG9naWMubGluZWFyVmVsb2NpdHkueSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmlzTGluZVN0b3AgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgb25Ub3VjaCgpIHtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMudG91Y2hfc3RhcnQsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLCB0aGlzLnRvdWNoX21vdmUsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIHRoaXMudG91Y2hfZW5kLCB0aGlzKTtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCB0aGlzLnRvdWNoX2VuZCwgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgb2ZmVG91Y2goKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFKTtcclxuICAgICAgICB0aGlzLm5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwpO1xyXG4gICAgfSxcclxuICAgIHRvdWNoX3N0YXJ0OiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNDYW5EcmF3IHx8IHdpbmRvdy5pc1dpbikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgcG9zID0gdGhpcy5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGV2ZW50LmdldExvY2F0aW9uKCkpO1xyXG4gICAgICAgIHdpbmRvdy5pc1N0YXJ0RHJhdyA9IHRydWU7XHJcbiAgICAgICAgd2luZG93LlBvaW50UG9zID0gcG9zO1xyXG4gICAgICAgIHRoaXMuZ3JhcGhpY3MubW92ZVRvKHBvcy54LCBwb3MueSk7XHJcbiAgICAgICAgdGhpcy5saW5lX3BvaW50LnB1c2goY2MudjIocG9zLngsIHBvcy55KSk7XHJcbiAgICB9LFxyXG4gICAgdG91Y2hfbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQ2FuRHJhdyB8fCB3aW5kb3cuaXNXaW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHBvcyA9IHRoaXMubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihldmVudC5nZXRMb2NhdGlvbigpKTtcclxuICAgICAgICB3aW5kb3cuUG9pbnRQb3MgPSBwb3M7XHJcbiAgICAgICAgdGhpcy5ncmFwaGljcy5saW5lVG8ocG9zLngsIHBvcy55KTtcclxuICAgICAgICB0aGlzLmxpbmVfcG9pbnQucHVzaChjYy52Mihwb3MueCwgcG9zLnkpKTtcclxuXHJcbiAgICAgICAgaWYod2luZG93LmlzVG91Y2hXYWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlQ29sb3IgPSBjYy5Db2xvci5SRURcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdyYXBoaWNzLnN0cm9rZUNvbG9yID0gY2MuQ29sb3IuQkxBQ0tcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZ3JhcGhpY3Muc3Ryb2tlKCk7XHJcbiAgICB9LFxyXG4gICAgdG91Y2hfZW5kOiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBpZih3aW5kb3cuaXNUb3VjaFdhbGwpIHtcclxuICAgICAgICAgICAgU3RhdGVGb3JKcy5pc0NhbkRyYXcgPSB0cnVlO1xyXG4gICAgICAgICAgICB3aW5kb3cuaXNUb3VjaFdhbGwgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5saW5lX3BvaW50ID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQ2FuRHJhdyB8fCB3aW5kb3cuaXNXaW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pc0NhbkRyYXcgPSBmYWxzZTtcclxuICAgICAgICB3aW5kb3cuaXNEcmF3ID0gdHJ1ZTtcclxuICAgICAgICB3aW5kb3cuaXNUb3VjaFdhbGwgPSBmYWxzZVxyXG4gICAgICAgIHRoaXMuY3JlYXRlUmlnaWJvZHkoKTtcclxuICAgICAgICB0aGlzLm9mZlRvdWNoKCk7XHJcbiAgICB9LFxyXG4gICAgY3JlYXRlUmlnaWJvZHk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnJpZ2lib2R5TG9naWMgPSB0aGlzLmFkZENvbXBvbmVudChjYy5SaWdpZEJvZHkpO1xyXG4gICAgICAgIHRoaXMucmlnaWJvZHlMb2dpYy5ncmF2aXR5U2NhbGUgPSAxMDtcclxuXHJcbiAgICAgICAgdGhpcy5waHlzaWNzTGluZSA9IHRoaXMuYWRkQ29tcG9uZW50KFwiTXlQaHlzaWNzQ29sbGlkZXJcIik7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzTGluZS5saW5lV2lkdGggPSA5O1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUucG9pbnRzID0gdGhpcy5saW5lX3BvaW50O1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUuZnJpY3Rpb24gPSAwO1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUuZGVuc2l0eSA9IDA7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzTGluZS50YWcgPSA1O1xyXG4gICAgICAgIHRoaXMucGh5c2ljc0xpbmUuYXBwbHkoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmlzQWN0aXZlTGluZUxvZ2ljID0gdHJ1ZTtcclxuICAgICAgICB9LCAwLjMpO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgYXBwbHlDb250YWN0KCkge1xyXG4gICAgICAgIHRoaXMucmlnaWJvZHlMb2dpYy5vbkJlZ2luQ29udGFjdCA9IChjLHMsbykgPT4ge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBjaGVja0lzQ2FuRHJhdzogZnVuY3Rpb24gKGxhc3RQb2ludCwgbm93UG9pbnQpIHtcclxuICAgICAgICByZXR1cm4gbGFzdFBvaW50LnN1Yihub3dQb2ludCkubWFnKCkgPj0gMjA7XHJcbiAgICB9LFxyXG5cclxufSk7XHJcbiJdfQ==